import{l as se,d as y,j as ie,e as l,f as S,o as n,a as e,m as P,x as De,F as E,h as V,t as $,b as j,v as D,w as B,g as U,p as Te,k as G,i as Se,c as M,s as Ie,V as A,S as Ue,q as Le,u as Ce,Z as Oe}from"./app-vGR4VHCP.js";import{_ as ce}from"./LabelModel-BQtPKLWR.js";import{I as Me}from"./InputModel-BvMn92CJ.js";import{B as Ne}from"./ButtonPrimary-27H6vMbw.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as de}from"./ButtonPrimaryMedio-C9HfT39S.js";import{d as Ae}from"./index-CWjNdAPT.js";import{B as je}from"./ButtonCancelar-DXabxgHh.js";import{B as Be}from"./ButtonEditeMedio-BwSG8MHL.js";import{L as Ge}from"./LayoutFranqueado-Dg4kLBEk.js";const ze={key:0,class:"w-[100%] h-full flex flex-col p-4 bg-gray-50"},Qe={class:"mb-6 relative"},Ke={class:"relative"},We=["value"],Je={class:"w-full bg-white rounded-lg p-6 mb-6"},He={class:"flex items-center"},Xe={class:"flex-shrink-0"},Ze=["src"],Ye={class:"ml-6"},et={class:"text-2xl font-semibold text-gray-800"},tt={key:0,class:"text-red-500 text-sm text-center"},ot={class:"relative flex items-center w-full"},at={class:"flex justify-end space-x-4"},rt={__name:"CadastrarInsumoEstoque",props:{produtoSelecionado:{type:Object,required:!1}},setup(r,{emit:s}){var R;const u=se(),i=s,c=r,h=y([]),_=y(""),g=y(""),x=y(((R=c.produtoSelecionado)==null?void 0:R.valor)||""),d=y(!1);y(!1);const m=y(!1),b=y(""),p=ie(()=>c.produtoSelecionado.unidadeDeMedida==="a_granel"?"Kg":"Quantidade"),f=()=>{if(!g.value.trim()){d.value=!1;return}let I=/^[0-9]+([.,][0-9]+)?$/;if(c.produtoSelecionado.unidadeDeMedida==="unidade"&&(I=/^[0-9]+$/),d.value=!I.test(g.value),["a_granel","quilo"].includes(c.produtoSelecionado.unidadeDeMedida)){let k=g.value.replace(/\D/g,""),C=k.slice(0,-3)||"0",O=k.slice(-3).padStart(3,"0");g.value=`${Number(C).toLocaleString("pt-BR")},${O}`}},a=()=>{const I=x.value.replace(/\D/g,""),k=I.slice(0,-2)||"0",C=I.slice(-2).padStart(2,"0");x.value=`R$ ${Number(k).toLocaleString("pt-BR")},${C}`},o=()=>{g.value="",x.value=""};(async()=>{try{const I=await G.get("/api/estoque/fornecedores");h.value=I.data.data.map(k=>({id:k.id||"N/D",razao_social:k.razao_social||"N/D"}))}catch(I){console.error("Erro ao carregar fornecedores:",I)}})();const v=I=>I?new URL(I,window.location.origin).href:"/storage/images/no_imagem.svg",w=()=>(b.value="",_.value?!g.value||d.value?(u.error("Quantidade inválida."),b.value="Quantidade inválida.",!1):!x.value||m.value?(u.error("Valor inválido."),b.value="Valor inválido.",!1):!0:(u.error("Fornecedor não selecionado."),b.value="Fornecedor não selecionado.",!1)),q=()=>{if(!w())return;const I={...c.produtoSelecionado,fornecedor_id:_.value,quantidade:g.value,valor:x.value,unidade_de_medida:c.produtoSelecionado.unidadeDeMedida};u.success("Inusmo adicionado"),o(),i("adicionarAoCarrinho",I)};return(I,k)=>r.produtoSelecionado?(n(),l("div",ze,[k[5]||(k[5]=e("h3",{class:"text-xl font-bold mb-4 text-gray-500"}," Estou recebendo os itens de ",-1)),e("div",Qe,[e("div",Ke,[P(e("select",{"onUpdate:modelValue":k[0]||(k[0]=C=>_.value=C),id:"fornecedor",class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-green-600 focus:ring-2 focus:ring-green-500 font-['Figtree']"},[k[3]||(k[3]=e("option",{value:"",disabled:""},"Selecione um fornecedor",-1)),(n(!0),l(E,null,V(h.value,C=>(n(),l("option",{key:C.id,value:C.id},$(C.razao_social),9,We))),128))],512),[[De,_.value]])])]),e("div",Je,[e("div",He,[e("div",Xe,[e("img",{src:v(r.produtoSelecionado.profile_photo),alt:"Foto do Produto",class:"w-24 h-24 rounded-lg"},null,8,Ze)]),e("div",Ye,[e("div",et,$(r.produtoSelecionado.nome||"N/A"),1)])])]),e("form",{onSubmit:Te(q,["prevent"]),class:"space-y-4"},[e("div",null,[j(ce,{text:p.value},null,8,["text"]),j(Me,{modelValue:g.value,"onUpdate:modelValue":k[1]||(k[1]=C=>g.value=C),placeholder:"0,000",onInput:f},null,8,["modelValue"]),d.value?(n(),l("p",tt," Insira um valor válido. ")):S("",!0)]),e("div",null,[j(ce,{text:"Valor"}),e("div",ot,[P(e("input",{"onUpdate:modelValue":k[2]||(k[2]=C=>x.value=C),placeholder:"R$ 0,00",onInput:a,class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},null,544),[[D,x.value]])])]),e("div",at,[j(Ne,{onClick:q},{default:B(()=>k[4]||(k[4]=[U("Adicionar")])),_:1})])],32)])):S("",!0)}},nt=L(rt,[["__scopeId","data-v-833469c3"]]),st={class:"flex gap-5"},it={key:0,class:"loading-overlay"},dt={class:"flex-1"},lt={class:"min-w-full table-auto"},ut=["onDblclick"],ct={class:"px-6 py-4 text-[16px] text-left text-gray-900 font-semibold"},pt={class:"px-6 py-4 text-[16px] text-gray-900 font-semibold text-center"},ft=["onUpdate:modelValue"],vt={key:1},gt={class:"px-6 py-4 text-[16px] text-gray-900 font-semibold text-left"},mt={key:0},_t=["onUpdate:modelValue"],xt={key:2},bt={class:"px-6 py-4 text-[16px] text-gray-500 text-center"},yt=["onUpdate:modelValue"],ht={key:1},$t={class:"px-6 py-4 text-center"},wt=["onClick"],kt={key:0,class:"botao-container"},qt={__name:"ResumoCarrinho",props:{carrinho:{type:Array,required:!0}},emits:["confirmar","cancelar"],setup(r,{emit:s}){const u=se(),i=r,c=s,h=y(!1),_=y(!1),g=y(null),x=a=>{i.carrinho.splice(a,1),u.info("Item removido com sucesso!")},d=a=>{g.value=a},m=a=>{const o=parseFloat(a.valor.replace("R$","").replace(/\./g,"").replace(",",".")),t=parseFloat(a.quantidade.replace(/\./g,"").replace(",","."));return t>0?o/t:0},b=a=>{const o=parseFloat(a.quantidade.replace(/\./g,"").replace(",","."));if(a.unidadeDeMedida==="a_granel"||a.unidadeDeMedida==="quilo")return m(a)*o||0;{const t=parseFloat(a.valor.replace("R$","").replace(/\./g,"").replace(",","."));return o*t}},p=async()=>{var a;h.value=!0,_.value=!0;try{const o={fornecedor_id:((a=i.carrinho[0])==null?void 0:a.fornecedor_id)||null,itens:i.carrinho.map(v=>{const w=parseFloat(v.quantidade.replace(/\./g,"").replace(",","."));let q=parseFloat(v.valor.replace("R$","").replace(/\./g,"").replace(",","."));q=q.toFixed(2);const R=parseFloat(b(v).toFixed(2));return console.log("Quantidade:",w),console.log("Valor Unitário:",q),console.log("Total:",R),{id:v.id,nome:v.nome,categoria_id:v.categoria_id,quantidade:w,unidadeDeMedida:v.unidadeDeMedida,valorUnitario:q,total:R}})};console.log("Dados enviados:",JSON.stringify(o,null,2));const t=await axios.post("/api/estoque/armazenar-entrada",o);t.status===201?(console.log("Resposta da API:",t.data),Ae.Inertia.visit(route("franqueado.inventario")),u.success("Lista de insumos salvas em seu estoque.")):u.error("Erro ao salvar no estoque, tente novamente.")}catch(o){console.error("Erro ao enviar entrada:",o),u.error("Erro ao confirmar entrada. Tente novamente ou chame o suporte.")}finally{h.value=!1}},f=()=>{c("cancelar")};return(a,o)=>(n(),l("div",st,[h.value?(n(),l("div",it,o[0]||(o[0]=[e("div",{class:"spinner"},null,-1)]))):S("",!0),o[3]||(o[3]=e("div",{class:"flex-1"},[e("div",{class:"painel-title"},"Confirmar entrada"),e("div",{class:"painel-subtitle"},[e("p",null,"Vamos conferir se está tudo certo")]),e("div",{class:"mt-[25%] text-[#6d6d6d] text-[18px] font-normal font-['Figtree'] leading-[23px] tracking-tight"},[U(" Você confirma que está "),e("br"),U(" realizando uma nova entrada "),e("br"),U(" com os seguintes itens? ")])],-1)),e("div",dt,[e("table",lt,[o[2]||(o[2]=e("thead",null,[e("tr",null,[e("th",{class:"px-6 py-3 text-xs text-left font-medium text-gray-500 uppercase tracking-wider TrRedonEsquerda"}," Item "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," QTD. "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," V. UN/KG "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"}," TOTAL "),e("th",{class:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider TrRedonDireita"}," AÇÃO ")])],-1)),e("tbody",null,[(n(!0),l(E,null,V(r.carrinho,(t,v)=>(n(),l("tr",{key:t.id,onDblclick:w=>d(v)},[e("td",ct,$(t.nome),1),e("td",pt,[g.value===v?P((n(),l("input",{key:0,type:"number","onUpdate:modelValue":w=>t.quantidade=w,class:"border border-gray-300 rounded px-2 py-1 w-16"},null,8,ft)),[[D,t.quantidade,void 0,{number:!0}]]):(n(),l("span",vt,$(t.quantidade)+" "+$(t.unidadeDeMedida==="a_granel"?"KG":"UN"),1))]),e("td",gt,[t.unidadeDeMedida==="a_granel"?(n(),l("span",mt," R$ "+$(m(t).toFixed(2)),1)):g.value===v?P((n(),l("input",{key:1,type:"text","onUpdate:modelValue":w=>t.valor=w,class:"border border-gray-300 rounded px-2 py-1 w-20"},null,8,_t)),[[D,t.valor]]):(n(),l("span",xt,$(t.valor),1))]),e("td",bt,[g.value===v&&t.unidadeDeMedida==="a_granel"?P((n(),l("input",{key:0,type:"number","onUpdate:modelValue":w=>t.valorTotal=w,class:"border border-gray-300 rounded px-2 py-1 w-20"},null,8,yt)),[[D,t.valorTotal,void 0,{number:!0}]]):(n(),l("span",ht,$(b(t).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),1))]),e("td",$t,[e("button",{onClick:w=>x(v),class:"w-[16] h-[16]"},o[1]||(o[1]=[e("img",{src:"/storage/images/delete.svg",alt:"icone de excluir",class:"w-[16px] h-[16px]"},null,-1)]),8,wt)])],40,ut))),128))])]),_.value?S("",!0):(n(),l("div",kt,[j(je,{text:"Voltar",onClick:f}),j(de,{text:"Confirmar",onClick:p})]))])]))}},Tt=L(qt,[["__scopeId","data-v-43226af9"]]),St={key:0},It={key:0,class:"sidebar-container"},Ct={key:0,class:"loading-overlay"},jt={key:1,class:"flex"},Rt={class:"flex-1 p-4"},Et={class:"relative flex items-center w-full mb-4"},Ft={class:"category-container"},Pt={class:"w-full h-[18.63px] text-[#6d6d6d] text-[15px] font-semibold font-['Figtree'] leading-tight mt-8 mb-1"},Vt={class:"card-container"},Dt=["onClick"],Ut={class:"card-inner"},Lt={class:"icon-container"},Ot={class:"icon-leaf"},Mt=["src"],Nt={class:"text-container"},At={class:"city"},Bt={key:0,class:"estrela"},Gt={key:1,class:"ml-5 text-xs bg-green-100 text-green-600 font-bold rounded-full px-2 py-1"},zt={class:"absolute bottom-4 right-4 mt-5 botao-container"},Qt={class:"flex-1 p-4"},Kt={__name:"CadastroProduto",props:{isVisible:{type:Boolean,required:!0}},setup(r){const s=y([]),u=y(""),i=y(!1),c=y(null),h=y([]),_=y(!1),g=()=>{console.log("Entrada confirmada",h.value),mostrarModalRevisao.value=!1,h.value=[]},x=async()=>{try{const o=await G.get("/api/produtos/lista");console.log("Produtos carregados:",o.data),typeof o.data=="object"&&o.data!==null?s.value=d(o.data):console.error("Esperava um objeto de categorias de produtos, mas recebi:",o.data)}catch(o){console.error("Erro ao carregar os produtos:",o)}};function d(o){const t=Object.keys(o),v={};return t.forEach(w=>{v[w]={categoria_nome:o[w].categoria_nome,produtos:o[w].produtos||[]}}),v}function m(o){return o?new URL(o,window.location.origin).href:"/storage/images/no_imagem.svg"}const b=o=>{c.value=o},p=o=>h.value.filter(t=>t.id===o).length,f=o=>{h.value.push(o),c.value=null},a=ie(()=>{const o=u.value.toLowerCase(),t={};return Object.keys(s.value).forEach(v=>{const w=s.value[v].produtos.filter(q=>q.nome.toLowerCase().includes(o));w.length>0&&(t[v]={categoria_nome:s.value[v].categoria_nome,produtos:w})}),t});return Se(x),(o,t)=>(n(),l(E,null,[j(Ie,{name:"fade"},{default:B(()=>[_.value?S("",!0):(n(),l("div",St,[r.isVisible?(n(),l("div",It,[i.value?(n(),l("div",Ct,t[3]||(t[3]=[e("div",{class:"spinner"},null,-1)]))):(n(),l("div",jt,[e("div",Rt,[t[7]||(t[7]=e("div",{class:"painel-title"},"Nova entrada",-1)),t[8]||(t[8]=e("div",{class:"painel-subtitle"},[e("p",null,"Adicione os itens que você recebeu ao estoque")],-1)),e("div",Et,[t[4]||(t[4]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),P(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=v=>u.value=v),placeholder:"Buscar um produto",class:"pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[D,u.value]])]),e("div",Ft,[(n(!0),l(E,null,V(a.value,(v,w)=>(n(),l("div",{key:w,class:"categoria-group"},[e("div",Pt,$(w),1),e("div",Vt,[(n(!0),l(E,null,V(v.produtos,q=>(n(),l("div",{key:q.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:R=>b(q)},[e("div",Ut,[e("div",Lt,[t[5]||(t[5]=e("div",{class:"icon-bg"},null,-1)),e("div",Ot,[e("img",{src:m(q.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,Mt)])]),e("div",Nt,[e("div",At,[U($(q.nome)+" ",1),q.estrela?(n(),l("span",Bt,"★")):S("",!0),p(q.id)>0?(n(),l("span",Gt,$(p(q.id)),1)):S("",!0)])]),t[6]||(t[6]=e("div",{class:"action-icon"},null,-1))])],8,Dt))),128))])]))),128))])]),e("div",zt,[j(de,{text:"Finalizar",onClick:t[1]||(t[1]=v=>_.value=!0),iconPath:"/storage/images/arrow_left_alt.svg"})]),e("div",Qt,[j(nt,{produtoSelecionado:c.value,onAdicionarAoCarrinho:f},null,8,["produtoSelecionado"])])]))])):S("",!0)]))]),_:1}),_.value?(n(),M(Tt,{key:0,carrinho:h.value,onConfirmar:g,onCancelar:t[2]||(t[2]=v=>_.value=!1)},null,8,["carrinho"])):S("",!0)],64))}},Wt=L(Kt,[["__scopeId","data-v-ad18a692"]]);var Q,pe;function Re(){if(pe)return Q;pe=1;function r(s){var u=typeof s;return s!=null&&(u=="object"||u=="function")}return Q=r,Q}var K,fe;function Jt(){if(fe)return K;fe=1;var r=typeof A=="object"&&A&&A.Object===Object&&A;return K=r,K}var W,ve;function Ee(){if(ve)return W;ve=1;var r=Jt(),s=typeof self=="object"&&self&&self.Object===Object&&self,u=r||s||Function("return this")();return W=u,W}var J,ge;function Ht(){if(ge)return J;ge=1;var r=Ee(),s=function(){return r.Date.now()};return J=s,J}var H,me;function Xt(){if(me)return H;me=1;var r=/\s/;function s(u){for(var i=u.length;i--&&r.test(u.charAt(i)););return i}return H=s,H}var X,_e;function Zt(){if(_e)return X;_e=1;var r=Xt(),s=/^\s+/;function u(i){return i&&i.slice(0,r(i)+1).replace(s,"")}return X=u,X}var Z,xe;function Fe(){if(xe)return Z;xe=1;var r=Ee(),s=r.Symbol;return Z=s,Z}var Y,be;function Yt(){if(be)return Y;be=1;var r=Fe(),s=Object.prototype,u=s.hasOwnProperty,i=s.toString,c=r?r.toStringTag:void 0;function h(_){var g=u.call(_,c),x=_[c];try{_[c]=void 0;var d=!0}catch{}var m=i.call(_);return d&&(g?_[c]=x:delete _[c]),m}return Y=h,Y}var ee,ye;function eo(){if(ye)return ee;ye=1;var r=Object.prototype,s=r.toString;function u(i){return s.call(i)}return ee=u,ee}var te,he;function to(){if(he)return te;he=1;var r=Fe(),s=Yt(),u=eo(),i="[object Null]",c="[object Undefined]",h=r?r.toStringTag:void 0;function _(g){return g==null?g===void 0?c:i:h&&h in Object(g)?s(g):u(g)}return te=_,te}var oe,$e;function oo(){if($e)return oe;$e=1;function r(s){return s!=null&&typeof s=="object"}return oe=r,oe}var ae,we;function ao(){if(we)return ae;we=1;var r=to(),s=oo(),u="[object Symbol]";function i(c){return typeof c=="symbol"||s(c)&&r(c)==u}return ae=i,ae}var re,ke;function ro(){if(ke)return re;ke=1;var r=Zt(),s=Re(),u=ao(),i=NaN,c=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,_=/^0o[0-7]+$/i,g=parseInt;function x(d){if(typeof d=="number")return d;if(u(d))return i;if(s(d)){var m=typeof d.valueOf=="function"?d.valueOf():d;d=s(m)?m+"":m}if(typeof d!="string")return d===0?d:+d;d=r(d);var b=h.test(d);return b||_.test(d)?g(d.slice(2),b?2:8):c.test(d)?i:+d}return re=x,re}var ne,qe;function no(){if(qe)return ne;qe=1;var r=Re(),s=Ht(),u=ro(),i="Expected a function",c=Math.max,h=Math.min;function _(g,x,d){var m,b,p,f,a,o,t=0,v=!1,w=!1,q=!0;if(typeof g!="function")throw new TypeError(i);x=u(x)||0,r(d)&&(v=!!d.leading,w="maxWait"in d,p=w?c(u(d.maxWait)||0,x):p,q="trailing"in d?!!d.trailing:q);function R(T){var F=m,N=b;return m=b=void 0,t=T,f=g.apply(N,F),f}function I(T){return t=T,a=setTimeout(O,x),v?R(T):f}function k(T){var F=T-o,N=T-t,ue=x-F;return w?h(ue,p-N):ue}function C(T){var F=T-o,N=T-t;return o===void 0||F>=x||F<0||w&&N>=p}function O(){var T=s();if(C(T))return le(T);a=setTimeout(O,k(T))}function le(T){return a=void 0,q&&m?R(T):(m=b=void 0,f)}function Pe(){a!==void 0&&clearTimeout(a),t=0,m=o=b=a=void 0}function Ve(){return a===void 0?f:le(s())}function z(){var T=s(),F=C(T);if(m=arguments,b=this,o=T,F){if(a===void 0)return I(o);if(w)return clearTimeout(a),a=setTimeout(O,x),R(o)}return a===void 0&&(a=setTimeout(O,x)),f}return z.cancel=Pe,z.flush=Ve,z}return ne=_,ne}var so=no();const io=Ue(so),lo={key:0,class:"sidebar-container"},uo={key:0,class:"loading-overlay"},co={key:1},po={class:"w-full h-[80%] bg-white rounded-[20px] p-12"},fo={class:"relative w-full h-full"},vo={class:"flex items-center"},go={class:"w-1/1 flex justify-center"},mo=["src"],_o={class:"w-2/3 pl-5"},xo={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},bo={class:"text-[#6db631] text-[25px] font-bold font-['Figtree'] mt-3 tracking-tight"},yo={class:"mt-5"},ho={class:"min-w-full table-auto"},$o={class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider TrRedonDireita"},wo={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},ko={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},qo={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},To=["onUpdate:modelValue","onInput"],So={class:"px-6 py-2 text-[16px] text-gray-800 font-semibold text-center"},Io={class:"flex justify-left mt-12"},Co={__name:"EditarProduto",props:{isVisible:{type:Boolean,required:!0},produto:{type:Object,required:!0}},emits:["cancelar"],setup(r,{emit:s}){const u=se(),i=r,c=s,h=y(""),_=y(""),g=y(!1),x=y(!1),d=y("");Le(()=>i.produto,a=>{a&&(h.value=a.nome||"",_.value=a.categoria||"")},{immediate:!0});const m=a=>a?new URL(a,window.location.origin).href:"/storage/images/no_imagem.svg",b=io(a=>{G.put(`/api/estoque/estoque/lote/${a.id}`,{quantidade:a.quantidade}).then(o=>{u.success("Quantidade do lote atualizada!")}).catch(o=>{u.error("Erro ao atualizar o lote.")})},1e3),p=a=>{d.value=a,x.value=!0},f=()=>{c("cancelar")};return(a,o)=>(n(),M(Ie,{name:"fade"},{default:B(()=>[r.isVisible?(n(),l("div",lo,[g.value?(n(),l("div",uo,o[1]||(o[1]=[e("div",{class:"spinner"},null,-1)]))):(n(),l("div",co,[e("div",po,[e("div",fo,[e("div",vo,[e("div",go,[e("img",{src:m(r.produto.profile_photo),alt:"Foto do Produto",class:"w-20 h-20 rounded-md shadow-lg"},null,8,mo)]),e("div",_o,[e("div",xo,[U($(r.produto.nome||"N/A")+" ",1),e("div",bo,$(r.produto.unidadeDeMedida==="a_granel"&&r.produto.valor_pago_por_quilo_lote?r.produto.valor_pago_por_quilo_lote:r.produto.valor_total_lote),1)])])])])]),e("form",{onSubmit:o[0]||(o[0]=Te(t=>p("Atualizar este produto?"),["prevent"]))},[e("div",yo,[e("table",ho,[e("thead",null,[e("tr",null,[o[2]||(o[2]=e("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider TrRedonEsquerda"}," entrada ",-1)),o[3]||(o[3]=e("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider"}," Fornecedor ",-1)),o[4]||(o[4]=e("th",{class:"px-6 py-2 text-[15px] font-semibold text-[#1d5915] uppercase tracking-wider"}," qtd ",-1)),e("th",$o,$(r.produto.unidadeDeMedida==="unitario"?"v. unit":"v. kg"),1)])]),e("tbody",null,[(n(!0),l(E,null,V(r.produto.lotes,t=>(n(),l("tr",{key:t.id},[e("td",wo,$(t.data),1),e("td",ko,$(t.fornecedor),1),e("td",qo,[P(e("input",{"onUpdate:modelValue":v=>t.quantidade=v,type:"number",min:"0",class:"border rounded-lg px-2 py-1 w-[75px] h-[32px] text-center",onInput:v=>Ce(b)(t)},null,40,To),[[D,t.quantidade]])]),e("td",So,$(t.preco_unitario),1)]))),128))])])]),e("div",Io,[j(je,{text:"Voltar",onClick:f})])],32)]))])):S("",!0)]),_:1}))}},jo=L(Co,[["__scopeId","data-v-9ad6d994"]]),Ro={class:"elemento-fixo"},Eo={key:0,class:"w-full h-[200px] bg-white rounded-[20px] p-12"},Fo={class:"relative w-full h-full"},Po={class:"flex items-center"},Vo={class:"w-1/1 flex justify-center"},Do=["src"],Uo={class:"w-2/3 pl-5"},Lo={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},Oo={class:"text-[#6db631] text-[25px] font-bold font-['Figtree'] mt-3 tracking-tight"},Mo={key:1,class:""},No={class:"mt-8"},Ao={class:"min-w-full table-auto"},Bo={class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"},Go={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},zo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Qo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Ko={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Wo={class:"px-6 py-4 text-[16px] text-gray-500 font-semibold"},Jo={key:0,class:"mt-4"},Ho={__name:"DetalhesProduto",props:{produto:{type:Object,required:!0}},emits:["atualizar"],setup(r,{emit:s}){const u=s,i=y(!1),c=y(!1),h=()=>{y.dadosProduto.fetchProduto()},_=d=>d?new URL(d,window.location.origin).href:"/storage/images/no_imagem.svg",g=()=>{c.value=!c.value,i.value=!1},x=()=>{u("atualizar"),c.value=!1,i.value=!0};return(d,m)=>(n(),l("div",Ro,[c.value?S("",!0):(n(),l("div",Eo,[e("div",Fo,[e("div",Po,[e("div",Vo,[e("img",{src:_(r.produto.profile_photo),alt:"Foto do Usuário",class:"w-20 h-20 rounded-md shadow-lg"},null,8,Do)]),e("div",Uo,[e("div",Lo,[U($(r.produto.nome||"N/A")+" ",1),e("div",Oo," R$ "+$(r.produto.valor_total_lote),1)])])])])])),c.value?S("",!0):(n(),l("div",Mo,[e("div",No,[e("table",Ao,[e("thead",null,[e("tr",null,[m[0]||(m[0]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider TrRedonEsquerda"}," entrada ",-1)),m[1]||(m[1]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"}," Fornecedor ",-1)),m[2]||(m[2]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider"}," qtd ",-1)),e("th",Bo,$(r.produto.unidadeDeMedida==="unitario"?"v. unit":"v. kg"),1),m[3]||(m[3]=e("th",{class:"px-6 py-4 text-[15px] font-semibold text-gray-500 uppercase tracking-wider TrRedonDireita"}," total ",-1))])]),e("tbody",null,[(n(!0),l(E,null,V(r.produto.lotes,(b,p)=>(n(),l("tr",{key:p,class:"text-center"},[e("td",Go,$(b.data),1),e("td",zo,$(b.fornecedor),1),e("td",Qo,$(b.quantidade)+" "+$(r.produto.unidadeDeMedida==="unitario"?"uni":"kg"),1),e("td",Ko,$(b.preco_insumo),1),e("td",Wo,$(b.valor_total),1)]))),128))])])]),r.produto.id&&!c.value?(n(),l("div",Jo,[j(Be,{text:"Editar insumos","icon-path":"/storage/images/border_color.svg",onClick:g,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):S("",!0)])),c.value?(n(),M(jo,{key:2,ref:"dadosProduto",isVisible:c.value,produto:r.produto,onDadosProduto:h,onCancelar:x},null,8,["isVisible","produto"])):S("",!0)]))}},Xo=L(Ho,[["__scopeId","data-v-b0e3fa7d"]]),Zo={class:"search-container relative flex items-center w-full mb-4"},Yo={class:"card-container compromissos-container overflow-hidden"},ea={class:"w-full h-[18.63px] text-[#6d6d6d] text-[15px] font-semibold font-['Figtree'] leading-tight mt-8 mb-1"},ta={class:"card-container"},oa=["onClick"],aa={class:"card-inner"},ra={class:"icon-container"},na={class:"icon-leaf"},sa=["src"],ia={class:"text-container flex justify-between items-center"},da={class:"city"},la={class:"quantidade text-gray-600 font-semibold"},ua={__name:"ListarInsumos",emits:["produto-selecionado"],setup(r,{emit:s}){const u=s,i=y([]),c=y(""),h=async()=>{try{const p=await G.get("/api/estoque/lista");console.log("Dados brutos da API:",p.data),i.value=_(p.data),console.log("Produtos agrupados:",i.value)}catch(p){console.error("Erro ao carregar os produtos:",p)}};function _(p){if(!Array.isArray(p))return console.error("Esperava um array de categorias, mas recebi:",p),{};const f={};return p.forEach(a=>{f[a.categoria_nome]={categoria_nome:a.categoria_nome,produtos:a.produtos||[]}}),f}function g(p){return p?new URL(p,window.location.origin).href:"/storage/images/no_imagem.svg"}const x=p=>{u("produto-selecionado",p)},d=(p,f)=>{const a=f==="a_granel"?3:0;return parseFloat(p).toFixed(a)},m=p=>{if(!Array.isArray(p))return console.warn("getQuantidadeTotal recebeu um valor inválido:",p),0;console.log("Lotes recebidos para soma:",p);const f=p.filter(o=>{const t=Number(o.quantidade),v=!isNaN(t)&&t>0;return console.log(`Lote: ${JSON.stringify(o)}, Quantidade: ${t}, Válido: ${v}`),v});if(f.length===0)return console.warn("Nenhum lote com quantidade válida encontrado:",p),0;const a=f.reduce((o,t)=>o+Number(t.quantidade),0);return console.log("Total calculado:",a),d(a,f[0].unidadeDeMedida||"unitario")},b=ie(()=>{const p=c.value.toLowerCase(),f={};return Object.keys(i.value).forEach(a=>{const o=i.value[a].produtos.filter(t=>t.nome.toLowerCase().includes(p));o.length>0&&(f[a]={categoria_nome:i.value[a].categoria_nome,produtos:o})}),f});return Se(()=>{h()}),(p,f)=>(n(),l("div",null,[f[4]||(f[4]=e("div",{class:"painel-title"},"Inventário da loja",-1)),f[5]||(f[5]=e("div",{class:"painel-subtitle"},[e("p",null,"Verifique a quantidade de cada item")],-1)),e("div",Zo,[f[1]||(f[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),P(e("input",{type:"text","onUpdate:modelValue":f[0]||(f[0]=a=>c.value=a),placeholder:"Buscar um produto",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[D,c.value]])]),e("div",Yo,[(n(!0),l(E,null,V(b.value,(a,o)=>(n(),l("div",{key:o,class:"categoria-group"},[e("div",ea,$(a.categoria_nome),1),e("div",ta,[(n(!0),l(E,null,V(a.produtos,t=>(n(),l("div",{key:t.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:v=>x(t)},[e("div",aa,[e("div",ra,[f[2]||(f[2]=e("div",{class:"icon-bg"},null,-1)),e("div",na,[e("img",{src:g(t.profile_photo),alt:"Imagem do produto",class:"w-12 h-12 rounded-lg"},null,8,sa)])]),e("div",ia,[e("div",da,$(t.nome),1),e("div",la,$(m(t.lotes))+" "+$(t.unidadeDeMedida==="unitario"?"uni":"kg"),1)]),f[3]||(f[3]=e("div",{class:"action-icon"},null,-1))])],8,oa))),128))])]))),128))])]))}},ca=L(ua,[["__scopeId","data-v-fc9ec596"]]),pa={key:0,class:"mt-6"},fa={class:"grid grid-cols-1 gap-[3rem] mt-3 sm:grid-cols-2 card-container h-full overflow-hidden"},va={key:0},ga={class:"flex flex-col gap-4"},ma={key:1,class:"absolute bottom-4 right-4 botao-container"},_a={__name:"Index",setup(r){const s=y(null),u=y(0),i=y(!1),c=y(!1),h=()=>{i.value=!i.value},_=()=>{console.log("atualizando a lista"),s.value=null,u.value+=1},g=()=>{x(),i.value=!1},x=()=>{var b;(b=y("listarUnidades").value)==null||b.fetchUnidades()},d=m=>{s.value=m,console.info("Dados recebidos no evento produto-selecionado:",m)};return(m,b)=>(n(),M(Ge,null,{default:B(()=>[j(Ce(Oe),{title:"Insumos"}),i.value?(n(),l("div",pa,[j(Wt,{isVisible:i.value,onUnidadeCadastrada:g,onCancelar:h},null,8,["isVisible"])])):S("",!0),e("div",fa,[i.value?S("",!0):(n(),l("div",va,[(n(),M(ca,{key:u.value,ref:"listarUnidades",onUnidadeCadastrada:x,onProdutoSelecionado:d}))])),e("div",ga,[i.value?S("",!0):(n(),l(E,{key:0},[s.value?(n(),M(Xo,{key:0,onAtualizar:_,produto:s.value},null,8,["produto"])):S("",!0),c.value?S("",!0):(n(),l("div",ma,[j(de,{text:"Nova entrada",iconPath:"/storage/images/arrow_left_alt.svg",onClick:h})]))],64))])])]),_:1}))}},Ia=L(_a,[["__scopeId","data-v-dc8d0ba3"]]);export{Ia as default};
