import{d as c,i as N,e as v,o as n,a,b as m,F as $,h as R,t as l,n as P,k as S,l as M,j,c as C,f as h,w as q,u as K,Z as O}from"./app-vGR4VHCP.js";import{L as T}from"./LayoutFranqueado-Dg4kLBEk.js";import{E as U,C as Z}from"./EditarColaborador-ogYtGhNT.js";import{B as G}from"./ButtonPrimaryMedio-C9HfT39S.js";import{d as H}from"./index-CWjNdAPT.js";import{_ as k}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as E}from"./LabelModel-BQtPKLWR.js";import{C as w}from"./ConfirmDialog-1acut7He.js";/* empty css                                                                   */import{B as J}from"./ButtonEditeMedio-BwSG8MHL.js";import"./ButtonCancelar-DXabxgHh.js";const Q=["onClick"],W={class:"text-lg font-medium text-gray-900"},X={class:"flex items-center space-x-1"},Y={class:"text-sm text-gray-600"},aa={class:"flex items-center space-x-4"},ta={class:"text-sm text-gray-600"},ea={class:"text-sm text-gray-600"},oa={class:"text-sm text-gray-600"},sa={__name:"ListarCaixas",emits:["caixa-selecionado","abrir-cadastro"],setup(d,{emit:f}){const s=f,e=c([]),g=async()=>{try{const o=await S.get("/api/caixas/lista");e.value=o.data.data}catch(o){console.error("Erro ao carregar os caixas:",o)}},r=o=>new Date(o).toLocaleString("pt-BR",{dateStyle:"short",timeStyle:"short"});N(g);const x=o=>{s("caixa-selecionado",o)},p=()=>{H.Inertia.visit(route("franqueado.abrirCaixa"))};return(o,i)=>(n(),v("div",null,[i[1]||(i[1]=a("div",{class:"painel-title"},"Caixa Retroativo",-1)),i[2]||(i[2]=a("div",{class:"painel-subtitle"},[a("p",null,"Edite, exclua e adicione caixas retroativos")],-1)),m(G,{text:"Adicionar um novo caixa",class:"w-full",onClick:p}),(n(!0),v($,null,R(e.value,t=>(n(),v("div",{key:t.id,onClick:b=>x(t),class:"relative flex items-center bg-white p-4 rounded-lg cursor-pointer hover:bg-gray-100 transition mt-3"},[a("div",null,[a("p",W," Caixa N° "+l(t.id)+" | Valor "+l(t.valor_total_fechamento||0),1),a("div",X,[i[0]||(i[0]=a("img",{src:"/storage/images/usc.svg",alt:"Ícone",class:"w-[14px] h-[14px]"},null,-1)),a("p",Y,l(t.usuario_fechou),1)]),a("div",aa,[a("p",ta," Abriu: "+l(r(t.hora_abertura)),1),a("p",ea," Fechou: "+l(r(t.hora_fechamento)),1),a("p",oa,"Ativo: "+l(t.horas_aberto),1)])]),a("div",{class:P(["absolute right-4 top-1/2 transform -translate-y-1/2 px-2 py-1 rounded-full text-xs font-semibold text-white",{"bg-yellow-500":t.status==="Aberto","bg-green-500":t.status==="Fechado"}])},l(t.status),3)],8,Q))),128))]))}},ra=k(sa,[["__scopeId","data-v-3db1602c"]]),ia={class:"elemento-fixo"},la={key:0},na={key:0,class:"loading-overlay"},ca={class:"w-full h-[250px] bg-white rounded-tl-[20px] rounded-tr-[20px] p-7 relative"},da={class:"flex justify-between items-center"},ua={class:"w-2/3"},ma={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},va={class:"text-[20px] text-[#6DB631] font-bold focus:ring-2 focus:ring-green-500 mt-2 flex items-center"},fa={class:"grid grid-cols-2 gap-4 mt-8"},xa={class:"text-[17px] font-bold text-gray-800 focus:ring-2 focus:ring-green-500"},ga={class:"text-[17px] font-bold text-gray-800 focus:ring-2 focus:ring-green-500"},pa={key:0,class:"mt-4"},_a={__name:"DetalhesCaixa",props:{dados:{type:Object,required:!0}},emits:["voltar","atualiza"],setup(d,{emit:f}){const s=M(),e=d,g=f,r=c(!1),x=c(!1),p=c(!1),o=c(!1),i=c(!1),t=c("");c(!0);const b=()=>{r.value=!r.value,i.value=!1},V=()=>{g("atualizar"),r.value=!1,i.value=!0},z=j(()=>e.dados.salario?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e.dados.salario):"R$ 0,00"),D=async()=>{try{p.value=!1,o.value=!0;const u=await axios.post("/api/usuarios/regenera-pin",{user_id:e.dados.id});s.success("PIN atualizado com sucesso"),g("voltar")}catch(u){console.error("Erro ao atualizar o PIN:",u),s.error("Erro ao atualizar o PIN")}finally{o.value=!1}},B=u=>{t.value=u,x.value=!0},A=()=>{p.value=!1},F=()=>{x.value=!1,L()},I=()=>{x.value=!1},L=async()=>{if(!e.dados||!e.dados.id){s.error("Erro: Dados da conta não encontrados.");return}try{const u=await axios.delete(`/api/usuarios/delete/${e.dados.id}`);s.success("Conta excluída com sucesso"),g("voltar")}catch(u){s.error("Erro ao excluir a conta"),console.error("Erro ao excluir a conta:",u)}};return(u,_)=>{var y;return n(),v($,null,[a("div",ia,[r.value?h("",!0):(n(),v("div",la,[o.value?(n(),v("div",na,_[1]||(_[1]=[a("div",{class:"spinner"},null,-1)]))):h("",!0),a("div",null,[a("div",ca,[a("div",da,[a("div",ua,[a("div",ma," ID #"+l(d.dados.id)+" | "+l(d.dados.name||"sem informações"),1),a("div",va,[a("span",null,l(((y=d.dados.cargo)==null?void 0:y.nome)||"sem informações"),1)])]),a("button",{class:"text-gray-500 hover:text-red-600",onClick:_[0]||(_[0]=Ea=>B("Excluir essa conta?"))},_[2]||(_[2]=[a("img",{src:"/storage/images/delete.svg",alt:"Excluir",class:"w-6 h-6"},null,-1)]))]),a("div",fa,[a("div",null,[m(E,{text:"Aberto por:"}),a("p",xa,l(d.dados.email),1)]),a("div",null,[m(E,{text:"Fechado por:"}),a("p",ga,l(z.value),1)])]),d.dados.id&&!r.value?(n(),v("div",pa,[m(J,{text:"Editar caixa","icon-path":"/storage/images/border_color.svg",onClick:b})])):h("",!0)])])]))]),r.value?(n(),C(U,{key:0,user:d.dados,isVisible:r.value,onVoltar:V,onAtualizado:u.handleAtualizacao},null,8,["user","isVisible","onAtualizado"])):h("",!0),m(w,{isVisible:x.value,motivo:t.value,onConfirm:F,onCancel:I},null,8,["isVisible","motivo"]),m(w,{isVisible:p.value,motivo:t.value,onConfirm:D,onCancel:A},null,8,["isVisible","motivo"])],64)}}},ha=k(_a,[["__scopeId","data-v-0a7b1d08"]]),Ca={class:"grid grid-cols-1 sm:grid-cols-2 gap-6 mt-3 h-full"},ba={key:0,class:"mt-3"},ya={key:1},Na={__name:"CaixaRetroativo",setup(d){const f=c(0),s=c(null),e=c(!1),g=()=>{e.value=!e.value,e.value&&(s.value=null)},r=i=>{s.value=i},x=()=>{e.value=!1,f.value+=1,console.log("cancelarCadastro")},p=()=>{s.value=null,f.value+=1},o=()=>{f.value+=1,r.value=null};return(i,t)=>(n(),C(T,null,{default:q(()=>[m(K(O),{title:"Caixa Retroativo"}),a("div",Ca,[(n(),C(ra,{key:f.value,ref:"listaDados",onUsuarioSelecionado:r,onAbrirCadastro:g})),e.value?(n(),v("div",ba,[m(Z,{onVoltar:x})])):h("",!0),s.value?(n(),v("div",ya,[m(ha,{dados:s.value,onVoltar:p,onAtualiza:o},null,8,["dados"])])):h("",!0)])]),_:1}))}};export{Na as default};
