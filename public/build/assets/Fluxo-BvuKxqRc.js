import{e as i,o as r,a as e,f as _,t as x,l as de,d as c,i as z,k as f,j as R,c as ce,w as ue,b as p,u as pe,Z as me,F as M,h as P,g as A,p as B,m as C,v as V,n as T,x as xe}from"./app-vGR4VHCP.js";import{L as ve}from"./LayoutFranqueado-Dg4kLBEk.js";import{I as D}from"./InputModel-BvMn92CJ.js";import{B as j}from"./ButtonPrimaryMedio-C9HfT39S.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{d as O}from"./index-CWjNdAPT.js";import{_ as ge}from"./LabelModel-BQtPKLWR.js";const fe=["type"],_e={class:"text-center uppercase text-[#5a9f28] upp text-[15px] font-semibold font-['Figtree'] leading-tight"},be=["src"],he={__name:"ButtonSuave",props:{text:{type:String,required:!0,default:"Nome do Botão"},type:{type:String,default:"button"},iconPath:{type:String,required:!1}},emits:["click"],setup(m,{emit:s}){const u=s,v=()=>{u("click")};return(b,g)=>(r(),i("button",{type:m.type,onClick:v,class:"h-[46px] px-[38px] py-3 bg-white rounded-[133.33px] flex justify-center items-center gap-2.5"},[e("span",_e,x(m.text),1),m.iconPath?(r(),i("img",{key:0,src:m.iconPath,alt:"icon",class:"h-6 w-6"},null,8,be)):_("",!0)],8,fe))}},Q=E(he,[["__scopeId","data-v-0a3ca3a8"]]),ye=["type"],we={class:"text-center text-[#f3f8f3] text-[15px] font-semibold font-['Figtree'] leading-tight"},Ce=["src"],Fe={__name:"ButtonPrimaryMedioRed",props:{text:{type:String,required:!0,default:"Nome do Botão"},type:{type:String,default:"button"},iconPath:{type:String,required:!1}},emits:["click"],setup(m,{emit:s}){const u=s,v=()=>{u("click")};return(b,g)=>(r(),i("button",{type:m.type,onClick:v,class:"h-[46px] px-[38px] py-3 bg-[#FF2D55] rounded-[10px] shadow-[2px_2px_10px_0px_rgba(0,0,0,0.04)] flex justify-center items-center gap-2.5"},[e("span",we,x(m.text),1),m.iconPath?(r(),i("img",{key:0,src:m.iconPath,alt:"icon",class:"h-6 w-6"},null,8,Ce)):_("",!0)],8,ye))}},$e=E(Fe,[["__scopeId","data-v-d3892524"]]),ke={key:0,class:"loading-overlay"},Ve={class:"mt-5"},Se={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-6"},Re={class:"bg-white rounded-lg px-12 py-8"},Me={class:"w-full"},Pe={class:"py-3 flex items-center gap-5"},Be=["src","alt"],De={class:"w-fill text-[#262a27] text-[17px] font-semibold font-['Figtree'] leading-snug"},je={class:"py-2 w-ful"},Ee={class:"w-full h-[60px] bg-[#d2fac3] rounded-bl-[10px] rounded-br-[10px] px-12 flex justify-between items-center"},Ie={class:"text-[#1d5915] text-xl font-bold font-['Figtree'] leading-snug"},qe={class:"bg-white rounded-lg px-12 py-8"},Ne={class:"w-full"},Le={class:"w-[85px]"},Ue=["src","alt"],ze={class:"py-4 px-3 flex items-center gap-5"},Ae={class:"w-fill text-[#262a27] text-[17px] font-semibold font-['Figtree'] leading-snug w-[170px]"},Te={class:"py-2"},Oe={class:"py-2"},Qe={class:"w-full h-[60px] bg-[#d2fac3] rounded-bl-[10px] rounded-br-[10px] px-12 flex justify-between items-center"},Je={class:"text-[#1d5915] text-xl font-bold font-['Figtree'] leading-snug"},Ze={class:"text-[#1d5915] text-xl font-bold font-['Figtree'] leading-snug"},Ge={class:"mt-5 bottom-0 left-[250px] w-full max-w-screen-xl mx-auto"},He={class:"w-full h-[85px] p-5 flex justify-between items-center"},Ke={class:"flex gap-[13px]"},We={class:"flex justify-center items-center gap-2.5"},Xe={class:"w-[267px] h-auto"},Ye={class:"w-full mb-8"},et={class:"w-full mb-8"},tt={class:"w-full mb-8"},at={class:"w-[267px] h-auto"},ot={class:"w-full mb-2"},st={class:"flex flex-col flex-1"},lt=["value"],nt={class:"w-full mb-8 mt-4"},rt={class:"w-full mb-8"},it={key:3,class:"fixed top-0 left-0 right-0 bottom-0 bg-opacity-50 bg-gray-900 flex justify-center items-center"},dt={class:"w-[267px] h-auto"},ct={class:"w-full"},ut={__name:"Fluxo",setup(m){const s=de(),u=c(!1),v=c([]),b=c([]),g=c(null),I=c([]),F=c(!1),$=c(!1),k=c(!1),l=c(""),h=c(null),y=c(null),J=c("R$ 0,00");z(async()=>{try{const o=await f.get("/api/categorias/seleto-caixa");I.value=o.data}catch(o){console.error("Erro ao carregar categorias:",o)}});const q=R(()=>`R$ ${v.value.reduce((t,a)=>t+parseFloat(a.total_vendas_metodos_pagamento.replace("R$","").replace(/\./g,"").replace(",","."))||0,0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}`),N=R(()=>`R$ ${b.value.reduce((t,a)=>t+parseFloat(a.total_vendas_canais_vendas.replace("R$","").replace(/\./g,"").replace(",","."))||0,0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}`),Z=R(()=>b.value.reduce((o,t)=>o+(parseInt(t.quantidade_vendas_canais_vendas)||0),0)),G=()=>{if(!l.value.trim()){s.warning("Motivo não pode estar vazio!");return}if(l.value.length>50){s.warning("Motivo excede o limite de 50 caracteres!");return}const o=parseFloat(y.value.replace("R$","").replace(".","").replace(",",".").trim());if(isNaN(o)){s.warning("Valor inválido!");return}f.post("/api/caixas/adicionar-suprimento",{valor:o,motivo:l.value}).then(t=>{console.log("Sucesso:",t.data),s.success("Suprimento adicionado com sucesso!")}).catch(t=>{console.error("Erro:",t),s.error("Erro ao adicionar suprimento.")}),y.value="",l.value="",F.value=!1},H=async()=>{if(!g.value){s.warning("Por favor, selecione uma categoria!");return}if(l.value.length<5){s.warning("Precisa conter no mínimo 5 caracteres!");return}if(l.value.length>50){s.warning("Excede o limite de 50 caracteres!");return}const o=parseFloat(h.value.replace("R$","").replace(".","").replace(",",".").trim());if(isNaN(o)){s.warning("Valor inválido!");return}try{const t=await f.post("/api/caixas/remover-suprimento",{valor:o,categoria_id:g.value,motivo:l.value});if(t.data.confirmation_required){const a=t.data.existing_transaction,n=`
        Já existe uma transação hoje com:
        - Valor: R$${a.valor.toLocaleString("pt-BR",{minimumFractionDigits:2})}
        - Categoria: ${a.categoria}
        - Motivo: ${a.motivo}
        Deseja prosseguir com uma nova retirada?
      `;if(confirm(n)){const d=await f.post("/api/caixas/remover-suprimento",{valor:o,categoria_id:g.value,motivo:l.value,force:!0});s.success("Sangria realizada com sucesso!"),L()}else s.info("Operação cancelada pelo usuário.")}else s.success("Sangria realizada com sucesso!"),L()}catch(t){console.error("Erro:",t),s.error("Erro ao realizar a Sangria.")}},L=()=>{h.value="",g.value=null,l.value="",$.value=!1},K=async()=>{try{const o=await f.get("/api/caixas/valor-disponivel");o.data.status==="success"?J.value=`R$ ${o.data.data.valor_disponivel}`:console.error("Erro ao buscar valor do caixa:",error)}catch(o){console.error("Erro ao buscar valor do caixa:",o)}},W=()=>{F.value=!0},X=()=>{F.value=!1,l.value="",y.value=null},Y=()=>{k.value=!0},ee=()=>{k.value=!1},te=()=>{k.value=!1,re()},ae=()=>{$.value=!0,K()},oe=()=>{$.value=!1,l.value="",h.value=null},U=o=>{let t=o.replace(/\D/g,"");t||(t="0");const a=t.slice(0,-2)||"0",n=t.slice(-2);return`R$ ${Number(a).toLocaleString("pt-BR")},${n}`},se=(o,t)=>{const a=o.target;let n=a.value.replace(/\D/g,"");n||(n="0");const d=n.slice(0,-2)||"0",S=n.slice(-2).padStart(2,"0"),w=`R$ ${Number(d).toLocaleString("pt-BR")},${S}`;a.value=w,t.total_vendas_metodos_pagamento=w},le=(o,t)=>{const a=o.target;let n=a.value.replace(/\D/g,"");n||(n="0");const d=n.slice(0,-2)||"0",S=n.slice(-2).padStart(2,"0"),w=`R$ ${Number(d).toLocaleString("pt-BR")},${S}`;a.value=w,t.total_vendas_canais_vendas=w},ne=async()=>{u.value=!0;try{const o=await f.get("/api/caixas/metodos-canais-ativos");o.data.status==="success"?(console.log("Métodos de pagamento:",o.data.metodosPagamento),console.log("Canais de vendas:",o.data.canaisVendas),v.value=o.data.metodosPagamento.filter(t=>{var a;return(a=t.default_payment_method)==null?void 0:a.img_icon}).map(t=>({...t,total_vendas_metodos_pagamento:"R$ 0,00"})),b.value=o.data.canaisVendas.filter(t=>{var a;return(a=t.default_canal_de_vendas)==null?void 0:a.img_icon}).map(t=>({...t,total_vendas_canais_vendas:"R$ 0,00",quantidade_vendas_canais_vendas:0}))):s.error("Erro ao carregar os dados")}catch(o){console.error("Erro ao buscar métodos e canais ativos:",o),s.error("Erro ao carregar os dados")}finally{u.value=!1}},re=async()=>{u.value=!0;try{(await f.post("/api/caixas/fechar-caixa",{metodos:v.value,canais:b.value,total_metodos_pagamento:q.value,total_canais_vendas:N.value})).data.status==="success"?(s.success("Fechamento realizado com sucesso!"),O.Inertia.visit(route("franqueado.abrirCaixa"))):s.error("Erro ao realizar o fechamento")}catch(o){console.error("Erro ao enviar fechamento de caixa:",o),s.error("Erro ao realizar o fechamento")}finally{u.value=!1}},ie=async()=>{u.value=!0;try{const o=await f.get("/api/caixas/abertos");o.data&&o.data.aberto?console.log("caixa aberto, permanecendo na pagina"):(s.warning("Abra o caixa primeiro!"),O.Inertia.visit(route("franqueado.abrirCaixa")))}catch(o){console.error("Erro ao verificar caixa aberto:",o)}finally{u.value=!1}};return z(()=>{ie(),ne()}),(o,t)=>(r(),ce(ve,null,{default:ue(()=>[p(pe(me),{title:"Fluxo do Caixa"}),u.value?(r(),i("div",ke,t[10]||(t[10]=[e("div",{class:"spinner"},null,-1)]))):_("",!0),t[22]||(t[22]=e("div",{class:"flex justify-between items-center mb-4"},[e("div",null,[e("div",{class:"painel-title text-2xl sm:text-3xl md:text-4xl"}," Fluxo do caixa "),e("div",{class:"painel-subtitle"},[e("p",{class:"text-sm sm:text-base md:text-lg"}," Acompanhe seu negócio em tempo real ")])])],-1)),e("div",Ve,[e("div",Se,[e("div",null,[e("div",Re,[e("table",Me,[t[11]||(t[11]=e("thead",null,[e("tr",null,[e("th",{class:"text-gray-500 text-left text-sm sm:text-base md:text-lg font-semibold font-['Figtree'] leading-snug"}," Método de pagamento ")])],-1)),e("tbody",null,[(r(!0),i(M,null,P(v.value,a=>{var n;return r(),i("tr",{key:a.id},[e("td",Pe,[a.default_payment_method&&a.default_payment_method.img_icon?(r(),i("img",{key:0,src:`/${a.default_payment_method.img_icon}`,alt:a.default_payment_method.nome||"Método de pagamento",class:"w-8 h-8"},null,8,Be)):_("",!0),e("div",De,x(((n=a.default_payment_method)==null?void 0:n.nome)||"Desconhecido"),1)]),e("td",je,[p(D,{modelValue:a.total_vendas_metodos_pagamento,"onUpdate:modelValue":d=>a.total_vendas_metodos_pagamento=d,onInput:d=>se(d,a),class:"w-[120px]"},null,8,["modelValue","onUpdate:modelValue","onInput"])])])}),128))])])]),e("div",Ee,[t[12]||(t[12]=e("div",{class:"text-[#1d5915] text-xl font-bold font-['Figtree'] leading-snug"}," TOTAL ",-1)),e("div",Ie,x(q.value),1)])]),e("div",null,[e("div",qe,[e("table",Ne,[t[13]||(t[13]=e("thead",null,[e("tr",null,[e("th"),e("th",{class:"px-2 text-left text-gray-500 text-sm sm:text-base md:text-lg font-semibold font-['Figtree'] leading-snug"}," Canais de venda "),e("th",{class:"text-gray-500 text-sm sm:text-base md:text-lg font-semibold font-['Figtree'] leading-snug"}," Valor vendido "),e("th",{class:"text-gray-500 text-sm sm:text-base md:text-lg font-semibold font-['Figtree'] leading-snug"}," Pedidos ")])],-1)),e("tbody",null,[(r(!0),i(M,null,P(b.value,a=>{var n;return r(),i("tr",{key:a.id},[e("td",Le,[a.default_canal_de_vendas&&a.default_canal_de_vendas.img_icon?(r(),i("img",{key:0,src:`/${a.default_canal_de_vendas.img_icon}`,alt:a.default_canal_de_vendas.nome||"Canal de venda",class:"h-7 w-17 fill-stone-950"},null,8,Ue)):_("",!0)]),e("td",ze,[e("div",Ae,x(((n=a.default_canal_de_vendas)==null?void 0:n.nome)||"Desconhecido"),1)]),e("td",Te,[p(D,{modelValue:a.total_vendas_canais_vendas,"onUpdate:modelValue":d=>a.total_vendas_canais_vendas=d,onInput:d=>le(d,a),class:"w-[120px]",placeholder:"R$ 0,00"},null,8,["modelValue","onUpdate:modelValue","onInput"])]),e("td",Oe,[p(D,{modelValue:a.quantidade_vendas_canais_vendas,"onUpdate:modelValue":d=>a.quantidade_vendas_canais_vendas=d,placeholder:"0",class:"w-[120px]"},null,8,["modelValue","onUpdate:modelValue"])])])}),128))])])]),e("div",Qe,[e("div",Je,[t[14]||(t[14]=e("span",null,"Total:",-1)),A(" "+x(N.value),1)]),e("div",Ze,[t[15]||(t[15]=e("span",null,"Pedidos:",-1)),A(" "+x(Z.value),1)])])])])]),e("div",Ge,[e("div",He,[e("div",Ke,[p(Q,{class:"w-full",text:"Suprimento",iconPath:"",onClick:W}),p(Q,{class:"w-full",text:"Sangria",iconPath:"",onClick:ae})]),e("div",We,[p(j,{class:"w-full max-w-[200px]",text:"Fechar caixa",iconPath:"/storage/images/arrow_left_alt.svg",onClick:Y})])])]),F.value?(r(),i("div",{key:1,onClick:X,class:"fixed top-0 left-0 right-0 bottom-0 bg-opacity-50 bg-gray-900 flex justify-center items-center"},[e("div",{onClick:t[3]||(t[3]=B(()=>{},["stop"])),class:"w-[405px] h-auto px-[19px] py-[20px] bg-white rounded-[20px] flex flex-col justify-center items-center gap-[20px]"},[t[17]||(t[17]=e("div",{class:"w-[280px] h-auto relative"},[e("div",{class:"w-[83.46px] h-[83.46px] mx-auto mb-8"},[e("img",{src:"/storage/images/add_circle.svg",alt:""})]),e("div",{class:"text-center text-[#262a27] text-[22px] font-bold font-['Figtree']"},[e("p",null,"Quanto você vai adicionar?")])],-1)),e("div",Xe,[e("div",Ye,[C(e("input",{id:"valor","onUpdate:modelValue":t[0]||(t[0]=a=>y.value=a),onInput:t[1]||(t[1]=a=>y.value=U(y.value)),class:"w-full h-[42.16px] bg-white rounded-lg border-2 border-[#d7d7db] px-2 text-[17px] outline-none text-center",placeholder:"R$ 0,00"},null,544),[[V,y.value]])]),e("div",et,[t[16]||(t[16]=e("label",{for:"motivo",class:"block text-gray-800 text-[14.93px] font-semibold font-['Figtree']"}," Informações adicionais ",-1)),C(e("textarea",{id:"motivo","onUpdate:modelValue":t[2]||(t[2]=a=>l.value=a),class:"w-full h-24 bg-white rounded-lg border-2 border-[#d7d7db] px-2 py-1 text-[14px] outline-none resize-none",placeholder:"Digite aqui..."},null,512),[[V,l.value]]),e("p",{class:T(["text-right text-xs mt-1",{"text-gray-500":l.value.length<=50,"text-red-500":l.value.length>50}])},x(l.value.length)+"/50 caracteres ",3)]),e("div",tt,[p(j,{onClick:G,text:"Adicionar",class:"w-full"})])])])])):_("",!0),$.value?(r(),i("div",{key:2,onClick:oe,class:"fixed top-0 left-0 right-0 bottom-0 bg-opacity-50 bg-gray-900 flex justify-center items-center"},[e("div",{onClick:t[8]||(t[8]=B(()=>{},["stop"])),class:"w-[405px] h-auto px-[19px] py-[20px] bg-white rounded-[20px] flex flex-col justify-center items-center gap-[20px]"},[t[19]||(t[19]=e("div",{class:"w-[280px] h-auto relative"},[e("div",{class:"w-[83.46px] h-[83.46px] mx-auto mb-8"},[e("img",{src:"/storage/images/do_not_disturb_on.svg",alt:""})]),e("div",{class:"text-center text-[#262a27] text-[22px] font-bold font-['Figtree']"},[e("p",null,"Quanto você vai retirar?")])],-1)),e("div",at,[e("div",ot,[C(e("input",{id:"valor","onUpdate:modelValue":t[4]||(t[4]=a=>h.value=a),onInput:t[5]||(t[5]=a=>h.value=U(h.value)),class:"w-full h-[42.16px] bg-white rounded-lg border-2 border-[#d7d7db] px-2 text-[17px] outline-none text-center",placeholder:"R$ 0,00"},null,544),[[V,h.value]])]),e("div",st,[p(ge,{text:"Motivo e descrição",class:"mb-2"}),C(e("select",{"onUpdate:modelValue":t[6]||(t[6]=a=>g.value=a),class:"w-full h-[44px] bg-[#F3F8F3] border-gray-100 rounded-lg border-2 border-[#d7d7db] p-2 text-base text-[#6DB631] font-bold focus:ring-2 focus:ring-green-500"},[t[18]||(t[18]=e("option",{value:"",disabled:"",selected:""},"Selecione um item",-1)),(r(!0),i(M,null,P(I.value,a=>(r(),i("option",{key:a.id,value:a.id},x(a.nome),9,lt))),128))],512),[[xe,g.value]])]),e("div",nt,[C(e("textarea",{id:"motivo","onUpdate:modelValue":t[7]||(t[7]=a=>l.value=a),class:"w-full h-24 bg-white rounded-lg border-2 border-[#d7d7db] px-2 py-1 text-[14px] outline-none resize-none",placeholder:"Descreva aqui os detalhes sobre a operação de sangria..."},null,512),[[V,l.value]]),e("p",{class:T(["text-right text-xs mt-1",{"text-gray-500":l.value.length<=50,"text-red-500":l.value.length>50}])},x(l.value.length)+"/50 caracteres ",3)]),e("div",rt,[p($e,{onClick:H,text:"Retirar",class:"w-full"})])])])])):_("",!0),k.value?(r(),i("div",it,[e("div",{onClick:t[9]||(t[9]=B(()=>{},["stop"])),class:"w-[405px] h-auto px-[19px] py-[20px] bg-white rounded-[20px] flex flex-col justify-center items-center gap-[20px]"},[t[21]||(t[21]=e("div",{class:"w-[280px] h-auto relative p-5"},[e("div",{class:"w-[83.46px] h-[83.46px] mx-auto mb-5"},[e("img",{src:"/storage/images/thumb_up_confirmar.svg",alt:""})]),e("div",{class:"text-center text-[#262a27] text-[22px] font-bold font-['Figtree']"},[e("p",null,"Confirmar fechamento do caixa de hoje?")])],-1)),e("div",dt,[e("div",ct,[p(j,{onClick:te,text:"Confirmar",class:"w-full"})]),e("div",{class:"mt-3 text-center text-[#ff2d55] text-[15px] font-bold font-['Figtree']",onClick:ee},t[20]||(t[20]=[e("p",{class:"cursor-pointer"},"Corrigir informações?",-1)]))])])])):_("",!0)]),_:1}))}},bt=E(ut,[["__scopeId","data-v-49daa6b6"]]);export{bt as default};
