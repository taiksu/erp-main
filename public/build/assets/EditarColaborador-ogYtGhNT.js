import{l as q,d as r,i as G,k as P,e as n,o as i,a as l,f as x,b as c,m as y,F as U,p as j,x as H,h as K,t as C,v as h}from"./app-vGR4VHCP.js";import{_}from"./LabelModel-BQtPKLWR.js";import{B as Q}from"./ButtonPrimaryMedio-C9HfT39S.js";import{B as W}from"./ButtonCancelar-DXabxgHh.js";import{C as Y}from"./ConfirmDialog-1acut7He.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ae={key:0,class:"loading-overlay"},oe={class:"mt-5"},le={class:"bg-white rounded-lg p-12"},te={class:"flex gap-8 mb-8"},re={class:"flex flex-col items-center"},se={class:"relative group"},ne=["src"],ie={key:1,src:"/storage/images/arrow_upload_ready.svg",alt:"Ícone de upload"},ue={class:"flex flex-col flex-1"},de=["value"],ce={key:0,class:"text-red-500 text-sm"},pe={key:1,class:"text-red-500 text-sm"},ve={key:2,class:"text-red-500 text-sm"},me={key:3,class:"text-red-500 text-sm"},fe={class:"form-buttons"},ge={__name:"CadastroColaborador",emits:["voltar"],setup(X,{emit:z}){const p=q(),I=z,w=r(""),D=r(""),v=r(""),m=r(""),f=r(null),g=r(""),b=r(null),$=r(null),F=r([]),u=r({}),V=r(!1),d=r(""),k=r(!1);G(async()=>{try{const t=await P.get("/api/usuarios/cargos");F.value=t.data}catch(t){console.error("Erro ao carregar cargos:",t)}});const R=t=>{let e=t.replace(/\D/g,"");return e=e.replace(/(\d{3})(\d)/,"$1.$2"),e=e.replace(/(\d{3})(\d)/,"$1.$2"),e=e.replace(/(\d{3})(\d{1,2})$/,"$1-$2"),e},S=t=>{let e=t.replace(/\D/g,"");e||(e="0");const a=e.slice(0,-2)||"0",o=e.slice(-2);return`R$ ${Number(a).toLocaleString("pt-BR")},${o}`},B=t=>{let e=t.replace("R$","").trim();return e=e.replace(".","").replace(",","."),parseFloat(e)},E=async()=>{if(u.value={},w.value||(u.value.nome="O nome é obrigatório"),D.value||(u.value.email="O email é obrigatório"),v.value||(u.value.cpf="O CPF é obrigatório"),m.value||(u.value.salario="O salário é obrigatório"),f.value||(u.value.cargo="O cargo é obrigatório"),Object.keys(u.value).length===0)try{k.value=!0;const t=new FormData;t.append("name",w.value),t.append("email",D.value),t.append("cpf",v.value),t.append("salario",B(m.value)),t.append("cargo_id",f.value),b.value&&t.append("profile_photo",b.value);const e=await P.post("/api/usuarios/cadastrar-colaborador",t,{headers:{"Content-Type":"multipart/form-data"}});p.success("Colaborador cadastrado com sucesso!"),console.log("Colaborador cadastrado:",e.data),O()}catch(t){p.error("Erro ao cadastrar colaborador"),console.error("Erro ao cadastrar colaborador:",t)}finally{k.value=!1}},L=t=>{d.value=t,V.value=!0},N=()=>{E(),V.value=!1},A=()=>{V.value=!1},M=()=>{var t;(t=$.value)==null||t.click()},T=()=>{g.value="",b.value=null,p.info("Imagem removida.")},J=t=>{const e=t.target.files[0];if(e){b.value=e;const a=new FileReader;a.onload=()=>{g.value=a.result,p.success("Imagem carregada com sucesso!")},a.readAsDataURL(e)}},O=()=>{w.value="",D.value="",v.value="",m.value="",f.value=null,g.value="",b.value=null,I("voltar")};return(t,e)=>(i(),n(U,null,[e[11]||(e[11]=l("div",{class:"painel-title"},"Cadastrar colaborador",-1)),e[12]||(e[12]=l("div",{class:"painel-subtitle"},[l("p",null,"Crie uma nova conta para acessar a sua loja")],-1)),k.value?(i(),n("div",ae,e[9]||(e[9]=[l("div",{class:"spinner"},null,-1)]))):x("",!0),l("div",oe,[l("div",le,[l("div",te,[l("div",re,[l("div",se,[l("div",{class:"w-[110px] h-[110px] bg-[#f3f8f3] rounded-xl flex items-center justify-center cursor-pointer overflow-hidden",onClick:M},[g.value?(i(),n(U,{key:0},[l("img",{src:g.value,alt:"Imagem selecionada",class:"w-full h-full object-cover"},null,8,ne),l("div",{class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",onClick:e[0]||(e[0]=j(()=>{},["stop"]))},[l("button",{onClick:j(T,["stop"]),class:"w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center font-bold text-sm"}," X ")])],64)):(i(),n("img",ie))]),l("input",{type:"file",ref_key:"fileInput",ref:$,accept:"image/*",class:"hidden",onChange:J},null,544)])]),l("div",ue,[c(_,{text:"Cargo",class:"mb-2"}),y(l("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>f.value=a),class:"w-72 h-[44px] bg-[#F3F8F3] border-gray-100 rounded-lg border-2 border-[#d7d7db] p-2 text-base text-[#6DB631] font-bold focus:ring-2 focus:ring-green-500"},[e[10]||(e[10]=l("option",{value:"",disabled:"",selected:""},"Selecione um cargo",-1)),(i(!0),n(U,null,K(F.value,a=>(i(),n("option",{key:a.id,value:a.id,class:"text-base font-semibold"},C(a.nome),9,de))),128))],512),[[H,f.value]])])]),c(_,{text:"Nome Completo"}),y(l("input",{id:"nome","onUpdate:modelValue":e[2]||(e[2]=a=>w.value=a),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:"João Silva Souza"},null,512),[[h,w.value]]),u.value.nome?(i(),n("span",ce,C(u.value.nome),1)):x("",!0),c(_,{text:"E-mail"}),y(l("input",{id:"email","onUpdate:modelValue":e[3]||(e[3]=a=>D.value=a),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:`usuario@email.com
`},null,512),[[h,D.value]]),u.value.email?(i(),n("span",pe,C(u.value.email),1)):x("",!0),c(_,{text:"CPF"}),y(l("input",{id:"cpf","onUpdate:modelValue":e[4]||(e[4]=a=>v.value=a),onInput:e[5]||(e[5]=a=>v.value=R(v.value)),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:"000.000.000-00",maxlength:"14"},null,544),[[h,v.value]]),u.value.cpf?(i(),n("span",ve,C(u.value.cpf),1)):x("",!0),c(_,{text:"Salário"}),y(l("input",{id:"salario","onUpdate:modelValue":e[6]||(e[6]=a=>m.value=a),onInput:e[7]||(e[7]=a=>m.value=S(m.value)),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:"R$ 1.600,00"},null,544),[[h,m.value]]),u.value.salario?(i(),n("span",me,C(u.value.salario),1)):x("",!0),l("div",fe,[c(W,{class:"w-full",text:"Cancelar",onClick:O}),c(Q,{text:"Cadastrar",class:"w-full",iconPath:"/storage/images/arrow_left_alt.svg",onClick:e[8]||(e[8]=a=>L("Cadastrar um novo colaborador?"))})])])]),c(Y,{isVisible:V.value,motivo:d.value,onConfirm:N,onCancel:A},null,8,["isVisible","motivo"])],64))}},Le=Z(ge,[["__scopeId","data-v-91740f90"]]),be={key:0,class:"loading-overlay"},xe={class:"mt-5"},ye={class:"bg-white rounded-lg p-12"},Ce={class:"flex gap-8 mb-8"},_e={class:"flex flex-col items-center"},$e={class:"relative group"},we=["src"],Fe={key:1,src:"/storage/images/arrow_upload_ready.svg",alt:"Ícone de upload"},ke={class:"flex flex-col flex-1"},he=["value"],De={key:0,class:"text-red-500 text-sm"},Ve={key:1,class:"text-red-500 text-sm"},Ie={key:2,class:"text-red-500 text-sm"},Ue={key:3,class:"text-red-500 text-sm"},Se={class:"form-buttons"},Re={__name:"EditarColaborador",props:{user:{type:Object,default:null}},emits:["voltar"],setup(X,{emit:z}){const p=X,I=q(),w=z,D=r(p.user?p.user.id:null),v=r(""),m=r(""),f=r(""),g=r(""),b=r(null),$=r(""),F=r(null),u=r(null),V=r([]),d=r({}),k=r(!1),R=r(""),S=r(!1);G(async()=>{try{const a=await P.get("/api/usuarios/cargos");V.value=a.data,p.user&&(v.value=p.user.name,m.value=p.user.email,f.value=B(p.user.cpf),g.value=E(p.user.salario.toString()),b.value=p.user.cargo_id,$.value=p.user.profile_photo_url||"")}catch(a){console.error("Erro ao carregar dados:",a)}});const B=a=>{let o=a.replace(/\D/g,"");return o=o.replace(/(\d{3})(\d)/,"$1.$2"),o=o.replace(/(\d{3})(\d)/,"$1.$2"),o=o.replace(/(\d{3})(\d{1,2})$/,"$1-$2"),o},E=a=>{let o=a.replace(/\D/g,"");o||(o="0");const s=o.slice(0,-2)||"0",ee=o.slice(-2);return`R$ ${Number(s).toLocaleString("pt-BR")},${ee}`},L=a=>{let o=a.replace("R$","").trim();return o=o.replace(".","").replace(",","."),parseFloat(o)},N=async()=>{if(d.value={},v.value||(d.value.nome="O nome é obrigatório"),m.value||(d.value.email="O email é obrigatório"),f.value||(d.value.cpf="O CPF é obrigatório"),g.value||(d.value.salario="O salário é obrigatório"),b.value||(d.value.cargo="O cargo é obrigatório"),Object.keys(d.value).length===0)try{S.value=!0;const a=new FormData;a.append("user_id",D.value),a.append("name",v.value),a.append("email",m.value),a.append("cpf",f.value),a.append("salario",L(g.value)),a.append("cargo_id",b.value),F.value&&a.append("profile_photo",F.value);const o=await P.post("/api/usuarios/atualiza-colaborador",a,{headers:{"Content-Type":"multipart/form-data"}});I.success("Colaborador atualizado com sucesso!"),console.log("Colaborador atualizado:",o.data),w("voltar"),e()}catch(a){I.error("Erro ao atualizar colaborador"),console.error("Erro ao atualizar colaborador:",a)}finally{S.value=!1}},A=a=>{R.value=a,k.value=!0},M=()=>{N(),k.value=!1},T=()=>{k.value=!1},J=()=>{var a;(a=u.value)==null||a.click()},O=()=>{$.value="",F.value=null,I.info("Imagem removida.")},t=a=>{const o=a.target.files[0];if(o){F.value=o;const s=new FileReader;s.onload=()=>{$.value=s.result,I.success("Imagem carregada com sucesso!")},s.readAsDataURL(o)}},e=()=>{v.value="",m.value="",f.value="",g.value="",b.value=null,$.value="",F.value=null,w("voltar")};return(a,o)=>(i(),n(U,null,[o[11]||(o[11]=l("div",{class:"painel-title"},"Editar colaborador",-1)),o[12]||(o[12]=l("div",{class:"painel-subtitle"},[l("p",null,"Atualize as informações do colaborador")],-1)),S.value?(i(),n("div",be,o[9]||(o[9]=[l("div",{class:"spinner"},null,-1)]))):x("",!0),l("div",xe,[l("div",ye,[l("div",Ce,[l("div",_e,[l("div",$e,[l("div",{class:"w-[110px] h-[110px] bg-[#f3f8f3] rounded-xl flex items-center justify-center cursor-pointer overflow-hidden",onClick:J},[$.value?(i(),n(U,{key:0},[l("img",{src:$.value,alt:"Imagem selecionada",class:"w-full h-full object-cover"},null,8,we),l("div",{class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",onClick:o[0]||(o[0]=j(()=>{},["stop"]))},[l("button",{onClick:j(O,["stop"]),class:"w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center font-bold text-sm"}," X ")])],64)):(i(),n("img",Fe))]),l("input",{type:"file",ref_key:"fileInput",ref:u,accept:"image/*",class:"hidden",onChange:t},null,544)])]),l("div",ke,[c(_,{text:"Cargo",class:"mb-2"}),y(l("select",{"onUpdate:modelValue":o[1]||(o[1]=s=>b.value=s),class:"w-72 h-[44px] bg-[#F3F8F3] border-gray-100 rounded-lg border-2 border-[#d7d7db] p-2 text-base text-[#6DB631] font-bold focus:ring-2 focus:ring-green-500"},[o[10]||(o[10]=l("option",{value:"",disabled:"",selected:""},"Selecione um cargo",-1)),(i(!0),n(U,null,K(V.value,s=>(i(),n("option",{key:s.id,value:s.id,class:"text-base font-semibold"},C(s.nome),9,he))),128))],512),[[H,b.value]])])]),c(_,{text:"Nome Completo"}),y(l("input",{id:"nome","onUpdate:modelValue":o[2]||(o[2]=s=>v.value=s),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:"João Silva Souza"},null,512),[[h,v.value]]),d.value.nome?(i(),n("span",De,C(d.value.nome),1)):x("",!0),c(_,{text:"E-mail"}),y(l("input",{id:"email","onUpdate:modelValue":o[3]||(o[3]=s=>m.value=s),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:`usuario@email.com
`},null,512),[[h,m.value]]),d.value.email?(i(),n("span",Ve,C(d.value.email),1)):x("",!0),c(_,{text:"CPF"}),y(l("input",{id:"cpf","onUpdate:modelValue":o[4]||(o[4]=s=>f.value=s),onInput:o[5]||(o[5]=s=>f.value=B(f.value)),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:"000.000.000-00",maxlength:"14"},null,544),[[h,f.value]]),d.value.cpf?(i(),n("span",Ie,C(d.value.cpf),1)):x("",!0),c(_,{text:"Salário"}),y(l("input",{id:"salario","onUpdate:modelValue":o[6]||(o[6]=s=>g.value=s),onInput:o[7]||(o[7]=s=>g.value=E(g.value)),class:"w-full py-3 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']",placeholder:"R$ 1.600,00"},null,544),[[h,g.value]]),d.value.salario?(i(),n("span",Ue,C(d.value.salario),1)):x("",!0),l("div",Se,[c(W,{class:"w-full",text:"Cancelar",onClick:e}),c(Q,{text:"Atualizar",class:"w-full",iconPath:"/storage/images/arrow_left_alt.svg",onClick:o[8]||(o[8]=s=>A("Atualizar colaborador?"))})])])]),c(Y,{isVisible:k.value,motivo:R.value,onConfirm:M,onCancel:T},null,8,["isVisible","motivo"])],64))}},Ne=Z(Re,[["__scopeId","data-v-74dd71b8"]]);export{Le as C,Ne as E};
