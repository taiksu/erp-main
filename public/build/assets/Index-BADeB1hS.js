import{A as G}from"./LayoutFranqueadora-DZJsUdwc.js";import{e as p,o as r,a as e,m as M,v as D,F as E,h as q,t as w,g as N,k as S,d as o,l as L,q as H,f as F,p as z,b as s,c as j,w as K,u as W,Z as X,n as Y}from"./app-vGR4VHCP.js";import{B as P}from"./ButtonPrimaryMedio-C9HfT39S.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as ee}from"./ButtonEditeMedio-BwSG8MHL.js";import{d as A}from"./index-CWjNdAPT.js";import{I as y}from"./InputModel-BvMn92CJ.js";import{_ as C}from"./LabelModel-BQtPKLWR.js";import{B as J}from"./ButtonCancelar-DXabxgHh.js";import{C as ae}from"./ConfirmDialog-1acut7He.js";import"./user-BrYGJ_Un.js";o([]);const se={data(){return{unidades:[],searchQuery:""}},mounted(){this.fetchUnidades()},methods:{async fetchUnidades(){try{const t=await S.get("/api/unidades");this.unidades=t.data}catch(t){console.error("Erro ao carregar unidades:",t)}},selecionarUnidade(t){this.$emit("unidade-selecionada",{unidade:t.unidade,usuarios:t.usuarios,cidade:t.cidade})}},computed:{filteredUnidades(){return this.unidades.filter(t=>{const d=t.unidade.cidade||t.cidade;return d&&d.toLowerCase().includes(this.searchQuery.toLowerCase())})}}},te={class:"search-container relative flex items-center w-full mb-4"},de={class:"card-container"},le=["onClick"],oe={class:"card-inner"},ie={class:"text-container"},ne={class:"city"},re={class:"owner"};function ue(t,d,n,V,m,u){return r(),p("div",null,[d[4]||(d[4]=e("div",{class:"painel-title"},"Nossas Unidades",-1)),d[5]||(d[5]=e("div",{class:"painel-subtitle"},[e("p",null,"Listagem de todas as unidades da franquia")],-1)),e("div",te,[d[1]||(d[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),M(e("input",{type:"text","onUpdate:modelValue":d[0]||(d[0]=i=>m.searchQuery=i),placeholder:"Pesquisar unidades",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[D,m.searchQuery]])]),e("div",de,[(r(!0),p(E,null,q(u.filteredUnidades,i=>(r(),p("div",{key:i.unidade.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:l=>u.selecionarUnidade(i)},[e("div",oe,[d[2]||(d[2]=e("div",{class:"icon-container"},[e("div",{class:"icon-bg"}),e("div",{class:"icon-leaf"},[e("img",{src:"/storage/images/storefront-verde.svg",alt:"Ícone da Unidade"})])],-1)),e("div",ie,[e("div",ne,w(i.unidade.cidade||i.cidade),1),e("div",re,[i.usuarios.length>0?(r(),p(E,{key:0},[N(w(i.usuarios.map(l=>l.name).join(", ")),1)],64)):(r(),p(E,{key:1},[N("Unidade sem Franqueado")],64))])]),d[3]||(d[3]=e("div",{class:"action-icon"},null,-1))])],8,le))),128))])])}const ce=I(se,[["render",ue],["__scopeId","data-v-b42a2fe5"]]),ve={key:0,class:"sidebar-container"},pe={class:"w-full h-[680px] bg-white rounded-[20px] p-12"},me={class:"flex space-x-4"},fe={class:"flex flex-col w-1/2"},ge={class:"flex flex-col w-1/2"},xe={key:0,class:"error-message"},he={class:"form-buttons"},be={__name:"EditarUnidade",props:{isVisible:{type:Boolean,required:!0},unidade:{type:Object,required:!0}},emits:["cancelar"],setup(t,{emit:d}){const n=L(),V=t,m=d,u=o(""),i=o(""),l=o(""),x=o(""),h=o(""),b=o(""),_=o(""),U=o("");H(()=>V.unidade.unidade,g=>{g&&(u.value=g.id||"",l.value=g.cidade||"",i.value=g.cep||"",x.value=g.bairro||"",h.value=g.rua||"",b.value=g.numero||"",_.value=g.cnpj||"")},{immediate:!0});const k=()=>{m("cancelar")},B=async()=>{var g,c;if(!u.value||!_.value||!i.value||!h.value||!b.value){U.value="Por favor, preencha todos os campos obrigatórios.";return}try{await A.Inertia.put(route("unidades.update",V.unidade.unidade.id),{id:u.value,cep:i.value,cidade:l.value,bairro:x.value,rua:h.value,numero:b.value,cnpj:_.value}),n.success("Unidade atualizada com sucesso!"),m("cancelar")}catch(v){n.error("Erro ao atualizar a unidade."),U.value=((c=(g=v.response)==null?void 0:g.data)==null?void 0:c.message)||"Erro ao atualizar a unidade.",console.error("Erro na atualização:",v)}};return(g,c)=>t.isVisible?(r(),p("div",ve,[e("div",pe,[e("form",{onSubmit:z(B,["prevent"])},[M(e("input",{type:"hidden","onUpdate:modelValue":c[0]||(c[0]=v=>u.value=v)},null,512),[[D,u.value]]),s(C,{text:"CNPJ"}),s(y,{modelValue:_.value,"onUpdate:modelValue":c[1]||(c[1]=v=>_.value=v),placeholder:"CNPJ"},null,8,["modelValue"]),s(C,{text:"Cidade"}),s(y,{modelValue:l.value,"onUpdate:modelValue":c[2]||(c[2]=v=>l.value=v),placeholder:"Cidade"},null,8,["modelValue"]),s(C,{text:"CEP"}),s(y,{modelValue:i.value,"onUpdate:modelValue":c[3]||(c[3]=v=>i.value=v),placeholder:"CEP"},null,8,["modelValue"]),e("div",me,[e("div",fe,[s(C,{text:"Rua"}),s(y,{modelValue:h.value,"onUpdate:modelValue":c[4]||(c[4]=v=>h.value=v),placeholder:"Rua"},null,8,["modelValue"])]),e("div",ge,[s(C,{text:"Número"}),s(y,{modelValue:b.value,"onUpdate:modelValue":c[5]||(c[5]=v=>b.value=v),placeholder:"Número"},null,8,["modelValue"])])]),s(C,{text:"Bairro"}),s(y,{modelValue:x.value,"onUpdate:modelValue":c[6]||(c[6]=v=>x.value=v),placeholder:"Bairro"},null,8,["modelValue"]),U.value?(r(),p("div",xe,w(U.value),1)):F("",!0),e("div",he,[s(J,{text:"Cancelar",onClick:k}),s(P,{text:"Atualizar",onClick:B})])],32)])])):F("",!0)}},_e=I(be,[["__scopeId","data-v-b009dee9"]]),Ue={key:0,class:"w-full h-[350px] bg-white rounded-[20px] p-12"},ye={class:"relative w-full h-full"},Ce={class:"flex justify-between items-center absolute left-0 top-[50px] w-full"},Ve={class:"w-[135px] h-[43px] px-2.5 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},$e={class:"text-[#262a27] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},ke={class:"w-[219px] h-[43px] px-2.5 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},we={class:"text-[#262a27] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},Ee={class:"absolute left-0 top-0 text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[34px] tracking-tight"},Fe={class:"absolute bottom-0 left-0 w-full h-[100px] flex flex-col gap-1"},Be={class:"h-[43px] pl-4 pr-3 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},Ne={class:"text-[#6db631] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},je={key:1,class:"mt-4"},Pe={__name:"DetalhesUnidade",props:{unidade:{type:Object,required:!0}},setup(t){const d=o(!1),n=o(!1),V=()=>{o.dadosUnidade.fetchUnidades()},m=()=>{n.value=!n.value,d.value=!1},u=()=>{n.value=!1,d.value=!0};return(i,l)=>{var x,h,b,_,U;return r(),p(E,null,[n.value?F("",!0):(r(),p("div",Ue,[e("div",ye,[e("div",Ce,[e("div",Ve,[l[0]||(l[0]=e("div",{class:"w-6 h-6 rounded-full"},[e("img",{src:"/storage/images/storefront-bleck.svg",alt:"",class:"inline-block"})],-1)),e("div",$e," ID# "+w((((x=t.unidade.unidade)==null?void 0:x.id)??0).toString().padStart(4,"0")),1)]),e("div",ke,[l[1]||(l[1]=e("div",{class:"w-6 h-6 rounded-full"},[e("img",{src:"/storage/images/assured_workload.svg",alt:"",class:"inline-block"})],-1)),e("div",we,w(((h=t.unidade.unidade)==null?void 0:h.cnpj)||"N/A"),1)])]),e("div",Ee,w(((b=t.unidade.unidade)==null?void 0:b.cidade)||t.unidade.cidade||"N/A"),1),e("div",Fe,[l[2]||(l[2]=e("div",{class:"text-[#6d6d6d] text-[15px] font-semibold font-['Figtree'] leading-tight"}," Esta unidade pertence a ",-1)),e("div",Be,[e("div",Ne,[(U=(_=t.unidade)==null?void 0:_.usuarios)!=null&&U.length?(r(!0),p(E,{key:0},q(t.unidade.usuarios,k=>(r(),p("div",{key:k.id},w(k.name),1))),128)):(r(),p(E,{key:1},[N("Sem informações")],64))])])])])])),t.unidade.unidade.id&&!n.value?(r(),p("div",je,[s(ee,{text:"Editar Unidade","icon-path":"/storage/images/border_color.svg",onClick:m,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):F("",!0),n.value?(r(),j(_e,{key:2,ref:"dadosUnidade",isVisible:n.value,unidade:t.unidade,onDadosUnidade:V,onCancelar:u},null,8,["isVisible","unidade"])):F("",!0)],64)}}},Ie={key:0,class:"sidebar-container"},Me={key:0,class:"loading-overlay"},De={key:1,class:"painel-title"},qe={class:"w-full h-[525px] bg-white rounded-[20px] p-12"},Se={class:"flex space-x-4"},Le={class:"flex flex-col w-1/2"},ze={class:"flex flex-col w-1/2"},Ae={class:"form-buttons"},Je={__name:"CadastroUnidade",props:{isVisible:{type:Boolean,required:!0}},emits:["cancelar"],setup(t,{emit:d}){const n=L(),V=d,m=o(""),u=o(""),i=o(""),l=o(""),x=o(""),h=o(""),b=o(""),_=o(!1),U=o(!1),k=o(""),B=()=>{g(),V("cancelar")},g=()=>{m.value="",u.value="",i.value="",l.value="",x.value="",h.value="",b.value=""},c=()=>!m.value||!u.value||!l.value?(n.error("Por favor, preencha todos os campos obrigatórios."),b.value="Por favor, preencha todos os campos obrigatórios.",!1):!0,v=async()=>{var $,a;if(c())try{_.value=!0;const f=await S.post("/api/unidades",{cnpj:m.value,cep:u.value,cidade:i.value,bairro:l.value,rua:x.value,numero:h.value});A.Inertia.replace(route("franqueadora.unidades"),{unidades:f.data.unidades,preserveState:!0}),n.success("Unidade cadastrada com sucesso!"),g()}catch(f){n.error("Erro ao cadastrar unidade."),b.value=((a=($=f.response)==null?void 0:$.data)==null?void 0:a.message)||"Erro ao cadastrar unidade."}finally{_.value=!1}},Q=$=>{let a=$.target.value.replace(/\D/g,"");a.length>14&&(a=a.slice(0,14)),a=a.replace(/^(\d{2})(\d)/,"$1.$2"),a=a.replace(/^(\d{2})\.(\d{3})(\d)/,"$1.$2.$3"),a=a.replace(/\.(\d{3})(\d)/,".$1/$2"),a=a.replace(/(\d{4})(\d)/,"$1-$2"),m.value=a},R=$=>{let a=$.target.value.replace(/\D/g,"");a.length>8&&(a=a.slice(0,8)),a=a.replace(/(\d{5})(\d)/,"$1-$2"),u.value=a},T=$=>{k.value=$,U.value=!0},O=()=>{v(),U.value=!1},Z=()=>{U.value=!1};return($,a)=>t.isVisible?(r(),p("div",Ie,[_.value?(r(),p("div",Me,a[7]||(a[7]=[e("div",{class:"spinner"},null,-1)]))):(r(),p("div",De,"Dados da nova unidade")),a[8]||(a[8]=e("div",{class:"painel-subtitle"},[e("p",null,"Informações básicas sobre a operação")],-1)),e("div",qe,[e("form",{onSubmit:z(v,["prevent"])},[s(C,{text:"CNPJ"}),s(y,{modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=f=>m.value=f),onInput:Q,placeholder:"CNPJ"},null,8,["modelValue"]),s(C,{text:"Cidade"}),s(y,{modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=f=>i.value=f),placeholder:"Cidade"},null,8,["modelValue"]),s(C,{text:"CEP"}),s(y,{modelValue:u.value,"onUpdate:modelValue":a[2]||(a[2]=f=>u.value=f),onInput:R,placeholder:"CEP"},null,8,["modelValue"]),e("div",Se,[e("div",Le,[s(C,{text:"Rua"}),s(y,{modelValue:x.value,"onUpdate:modelValue":a[3]||(a[3]=f=>x.value=f),placeholder:"Rua"},null,8,["modelValue"])]),e("div",ze,[s(C,{text:"Número"}),s(y,{modelValue:h.value,"onUpdate:modelValue":a[4]||(a[4]=f=>h.value=f),placeholder:"Número"},null,8,["modelValue"])])]),s(C,{text:"Bairro"}),s(y,{modelValue:l.value,"onUpdate:modelValue":a[5]||(a[5]=f=>l.value=f),placeholder:"Bairro"},null,8,["modelValue"]),s(ae,{isVisible:U.value,motivo:k.value,onConfirm:O,onCancel:Z},null,8,["isVisible","motivo"]),e("div",Ae,[s(J,{text:"Cancelar",onClick:B}),s(P,{text:"Cadastrar",onClick:a[6]||(a[6]=f=>T("Criar nova unidade?"))})])],32)])])):F("",!0)}},Qe=I(Je,[["__scopeId","data-v-1bd4ab58"]]),Re={class:"grid grid-cols-1 gap-[3rem] mt-3 sm:grid-cols-2"},Te={class:"flex flex-col gap-4"},Oe={class:"absolute bottom-4 right-4"},Ze={key:1,class:"mt-4"},la={__name:"Index",setup(t){const d=o(null),n=o(!1),V=()=>{n.value=!n.value},m=()=>{u(),n.value=!1},u=()=>{o.listarUnidades.fetchUnidades()},i=l=>{d.value=l};return(l,x)=>(r(),j(G,null,{default:K(()=>[s(W(X),{title:"Unidades"}),e("div",Re,[e("div",null,[s(ce,{ref:"listarUnidades",onUnidadeCadastrada:u,onUnidadeSelecionada:i},null,512)]),e("div",Te,[n.value?(r(),p("div",Ze,[s(Qe,{isVisible:n.value,onUnidadeCadastrada:m,onCancelar:V},null,8,["isVisible"])])):(r(),p(E,{key:0},[d.value?(r(),j(Pe,{key:0,unidade:d.value},null,8,["unidade"])):F("",!0),e("div",Oe,[s(P,{text:"Nova Unidade",iconPath:"/storage/images/arrow_left_alt.svg",onClick:V,class:Y({hidden:l.isEditMode})},null,8,["class"])])],64))])])]),_:1}))}};export{la as default};
