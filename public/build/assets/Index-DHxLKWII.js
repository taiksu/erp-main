import{l as O,d as p,j as T,e as u,o as t,a as e,f as y,c as E,b as m,t as x,g as K,F as k,h as z,i as Z,k as H,w as J,u as Q,Z as W}from"./app-vGR4VHCP.js";import{L as X}from"./LayoutFranqueado-Dg4kLBEk.js";import{_ as h}from"./LabelModel-BQtPKLWR.js";import{C as q}from"./ConfirmDialog-1acut7He.js";import{D as Y}from"./Deslizante-DHmCuj6D.js";import{B as ee}from"./ButtonEditeMedio-BwSG8MHL.js";import{E as se,C as oe}from"./EditarColaborador-ogYtGhNT.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as ae}from"./ButtonPrimaryMedio-C9HfT39S.js";/* empty css                                                                   */import"./ButtonCancelar-DXabxgHh.js";const te={class:"elemento-fixo"},re={key:0},le={key:0,class:"loading-overlay"},ie={class:"w-full h-[300px] bg-white rounded-tl-[20px] rounded-tr-[20px] p-7 relative"},ne={class:"flex justify-between items-center"},de={class:"w-1/1 flex justify-center"},ue=["src"],ce={class:"w-2/3"},me={class:"text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[30px] tracking-tight"},fe={class:"w-72 h-[44px] bg-[#F3F8F3] border-gray-100 rounded-lg border-2 border-[#d7d7db] p-2 text-base text-[#6DB631] font-bold focus:ring-2 focus:ring-green-500 mt-2 flex items-center"},pe={class:"grid grid-cols-2 gap-4 mt-8"},_e={class:"w-full h-[44px] bg-white border-gray-300 rounded-lg border-2 border-[#d7d7db] p-2 text-base font-bold text-gray-800 focus:ring-2 focus:ring-green-500"},ge={class:"w-full h-[44px] bg-white border-gray-300 rounded-lg border-2 border-[#d7d7db] p-2 text-base font-bold text-gray-800 focus:ring-2 focus:ring-green-500"},ve={class:"flex justify-between items-center mt-5 w-full p-1"},xe={class:"flex items-center w-2/3"},be={key:0,class:"bg-[#EFEFEF] p-3 px-8 w-full rounded-bl-[20px] rounded-br-[20px]"},ye={class:"flex flex-col w-2/3"},Ce={class:"w-1/2 flex justify-end"},he={key:1,class:"flex flex-col h-[270px] items-center justify-center bg-[#EFEFEF] rounded-lg"},we={class:"text-[100px] font-bold text-[#6DB631]"},Ee={key:0,class:"mt-4"},ke={__name:"DetalhesColaborador",props:{dados:{type:Object,required:!0}},emits:["voltar","atualiza"],setup(i,{emit:_}){const a=O(),s=i,v=_,c=p(!1),g=p(!1),n=p(!1),r=p(!1),f=p(!1),b=p(""),w=p(!0),$=["id","user_id","created_at","updated_at"],D=()=>{c.value=!c.value,f.value=!1},P=()=>{v("atualizar"),c.value=!1,f.value=!0},B=()=>{w.value=!w.value},N=o=>({controle_estoque:"Gestão de Estoque",controle_saida_estoque:"Saída de Estoque",gestao_equipe:"Gestão de Equipe",fluxo_caixa:"Fluxo de Caixa",dre:"DRE",contas_pagar:"Contas a Pagar",gestao_salmao:"Gestão de Salmão"})[o]||o,j=T(()=>s.dados.salario?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s.dados.salario):"R$ 0,00"),A=async(o,l)=>{s.dados.user_permission||(s.dados.user_permission={}),s.dados.user_permission[o]=!!l,console.log(`Alterando ${o} para`,s.dados.user_permission[o]);const C={user_id:s.dados.id,controle_estoque:s.dados.user_permission.controle_estoque||!1,controle_saida_estoque:s.dados.user_permission.controle_saida_estoque||!1,gestao_equipe:s.dados.user_permission.gestao_equipe||!1,fluxo_caixa:s.dados.user_permission.fluxo_caixa||!1,dre:s.dados.user_permission.dre||!1,contas_pagar:s.dados.user_permission.contas_pagar||!1,gestao_salmao:s.dados.user_permission.gestao_salmao||!1};try{r.value=!0;const d=await axios.post("/api/usuarios/upsert-permissions",C);a.success("Permissões atualizadas com sucesso"),v("atualiza")}catch(d){console.error("Erro ao atualizar permissões:",d),a.error("Erro ao atualizar permissões")}finally{r.value=!1}},I=async()=>{try{n.value=!1,r.value=!0;const o=await axios.post("/api/usuarios/regenera-pin",{user_id:s.dados.id});a.success("PIN atualizado com sucesso"),v("voltar")}catch(o){console.error("Erro ao atualizar o PIN:",o),a.error("Erro ao atualizar o PIN")}finally{r.value=!1}},L=o=>{b.value=o,g.value=!0},S=o=>{b.value=o,n.value=!0},U=()=>{n.value=!1},G=()=>{g.value=!1,R()},M=()=>{g.value=!1},R=async()=>{if(!s.dados||!s.dados.id){a.error("Erro: Dados da conta não encontrados.");return}try{const o=await axios.delete(`/api/usuarios/delete/${s.dados.id}`);a.success("Conta excluída com sucesso"),v("voltar")}catch(o){a.error("Erro ao excluir a conta"),console.error("Erro ao excluir a conta:",o)}};return(o,l)=>{var C;return t(),u(k,null,[e("div",te,[c.value?y("",!0):(t(),u("div",re,[r.value?(t(),u("div",le,l[2]||(l[2]=[e("div",{class:"spinner"},null,-1)]))):y("",!0),e("div",null,[e("div",ie,[e("div",ne,[e("div",de,[e("img",{src:i.dados.profile_photo_url||"/storage/images/default-profile.png",alt:"Foto do Usuário",class:"w-20 h-20 rounded-md shadow-sm"},null,8,ue)]),e("div",ce,[e("div",me,x(i.dados.name||"N/A"),1),e("div",fe,[e("span",null,x(((C=i.dados.cargo)==null?void 0:C.nome)||"Cargo não atribuído"),1)])]),e("button",{class:"text-gray-500 hover:text-red-600",onClick:l[0]||(l[0]=d=>L("Excluir essa conta?"))},l[3]||(l[3]=[e("img",{src:"/storage/images/delete.svg",alt:"Excluir",class:"w-6 h-6"},null,-1)]))]),e("div",pe,[e("div",null,[m(h,{text:"E-mail"}),e("p",_e,x(i.dados.email),1)]),e("div",null,[m(h,{text:"Salário"}),e("p",ge,x(j.value),1)])]),e("div",ve,[e("div",xe,[l[4]||(l[4]=e("img",{class:"w-5 h-5 mr-2",src:"/storage/images/security_bleck.svg",alt:"icone svg"},null,-1)),m(h,{class:"font-semibold text-gray-900",text:"Permissões"})]),e("div",{class:"w-1/2 flex justify-end"},[e("p",{class:"font-bold text-[#6DB631] cursor-pointer",onClick:B},l[5]||(l[5]=[e("span",{class:"underline"},"***",-1),K(" PIN ")]))])])]),w.value?(t(),u("div",be,[(t(!0),u(k,null,z(Object.keys(i.dados.user_permission||{}).filter(d=>!$.includes(d)),d=>(t(),u("div",{key:d,class:"flex justify-between items-center"},[e("div",ye,[m(h,{class:"font-semibold text-gray-900",text:N(d)},null,8,["text"])]),e("div",Ce,[m(Y,{status:i.dados.user_permission[d],"onUpdate:status":F=>i.dados.user_permission[d]=F,onClick:F=>A(d,i.dados.user_permission[d])},null,8,["status","onUpdate:status","onClick"])])]))),128))])):(t(),u("div",he,[e("p",we,x(s.dados.pin),1),e("button",{onClick:l[1]||(l[1]=d=>S("Redefinir PIN?")),class:"text-[#FF2D55] font-semibold rounded-lg underline"}," Redefinir PIN ")]))])]))]),i.dados.id&&!c.value?(t(),u("div",Ee,[m(ee,{text:"Editar Colaborador","icon-path":"/storage/images/border_color.svg",onClick:D,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):y("",!0),c.value?(t(),E(se,{key:1,user:i.dados,isVisible:c.value,onVoltar:P,onAtualizado:o.handleAtualizacao},null,8,["user","isVisible","onAtualizado"])):y("",!0),m(q,{isVisible:g.value,motivo:b.value,onConfirm:G,onCancel:M},null,8,["isVisible","motivo"]),m(q,{isVisible:n.value,motivo:b.value,onConfirm:I,onCancel:U},null,8,["isVisible","motivo"])],64)}}},Fe=V(ke,[["__scopeId","data-v-2156ef12"]]),qe=["onClick"],ze=["src"],Ve={class:"text-lg font-medium text-gray-900"},$e={class:"text-sm text-gray-600"},De={__name:"ListarColaboradores",emits:["usuario-selecionado","abrir-cadastro"],setup(i,{emit:_}){const a=_,s=p([]);Z(async()=>{try{const n=await H.get("/api/usuarios/colaboradores");s.value=n.data.map(r=>({...r,permissions:r.permissions||{controle_estoque:!1,controle_saida_estoque:!1,gestao_equipe:!1,fluxo_caixa:!1,dre:!1,contas_pagar:!1}}))}catch(n){console.error("Erro ao carregar os usuários:",n)}});const c=n=>{a("usuario-selecionado",n)},g=()=>{a("abrir-cadastro")};return(n,r)=>(t(),u("div",null,[r[0]||(r[0]=e("div",{class:"painel-title"},"Gestão de equipe",-1)),r[1]||(r[1]=e("div",{class:"painel-subtitle"},[e("p",null,"Gerencie a sua equipe e permissões aqui")],-1)),m(ae,{text:"Cadastrar colaborador",class:"w-full",onClick:g}),(t(!0),u(k,null,z(s.value,f=>(t(),u("div",{key:f.id,onClick:b=>c(f),class:"flex items-center bg-white p-4 rounded-lg cursor-pointer hover:bg-gray-100 transition mt-3"},[e("img",{src:f.profile_photo_url,alt:"Foto de perfil",class:"w-12 h-12 object-cover mr-4"},null,8,ze),e("div",null,[e("p",Ve,x(f.name),1),e("p",$e,x(f.email),1)])],8,qe))),128))]))}},Pe=V(De,[["__scopeId","data-v-8e977923"]]),Be={class:"grid grid-cols-1 sm:grid-cols-2 gap-6 mt-3 h-full"},Ne={key:0,class:"mt-3"},je={key:1},Ze={__name:"Index",setup(i){const _=p(0),a=p(null),s=p(!1),v=()=>{s.value=!s.value,s.value&&(a.value=null)},c=f=>{a.value=f},g=()=>{s.value=!1,_.value+=1,console.log("cancelarCadastro")},n=()=>{a.value=null,_.value+=1},r=()=>{_.value+=1,c.value=null};return(f,b)=>(t(),E(X,null,{default:J(()=>[m(Q(W),{title:"Gestão de Equipe"}),e("div",Be,[(t(),E(Pe,{key:_.value,ref:"listaDados",onUsuarioSelecionado:c,onAbrirCadastro:v})),s.value?(t(),u("div",Ne,[m(oe,{onVoltar:g})])):y("",!0),a.value?(t(),u("div",je,[m(Fe,{dados:a.value,onVoltar:n,onAtualiza:r},null,8,["dados"])])):y("",!0)])]),_:1}))}};export{Ze as default};
