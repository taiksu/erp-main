import{A as G}from"./LayoutFranqueadora-DZJsUdwc.js";import{d as r,j as Q,e as h,o as p,a as e,m as Z,v as H,F as I,h as K,t as C,k as S,l as M,q as T,f as E,b as o,p as R,c as B,w as W,s as X,u as Y,Z as ee}from"./app-vGR4VHCP.js";import{B as P}from"./ButtonPrimaryMedio-C9HfT39S.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{d as U}from"./index-CWjNdAPT.js";import{_}from"./LabelModel-BQtPKLWR.js";import{B as oe}from"./ButtonEditeMedio-BwSG8MHL.js";import{I as k}from"./InputModel-BvMn92CJ.js";import{B as O}from"./ButtonCancelar-DXabxgHh.js";import{C as q}from"./ConfirmDialog-1acut7He.js";import"./user-BrYGJ_Un.js";const te={class:"search-container relative flex items-center w-full mb-4"},ae={class:"card-container"},se=["onClick"],re={class:"card-inner"},le={class:"text-container"},ne={class:"city"},ie={class:"owner"},de={__name:"ListarFornecedores",emits:["fornecedor-selecionado"],setup(x,{emit:y}){const d=y,b=r([]),u=r(""),l=async()=>{try{const a=await S.get("/api/fornecedores");b.value=a.data.data}catch(a){console.error("Erro ao carregar fornecedores:",a)}},m=a=>{d("fornecedor-selecionado",a)},c=Q(()=>{const a=u.value.toLowerCase();return b.value.filter(s=>s.razao_social.toLowerCase().includes(a)||s.cnpj.toLowerCase().includes(a))});return l(),(a,s)=>(p(),h("div",null,[s[4]||(s[4]=e("div",{class:"painel-title"},"Fornecedores",-1)),s[5]||(s[5]=e("div",{class:"painel-subtitle"},[e("p",null,"Fornecedores de insumos homologados")],-1)),e("div",te,[s[1]||(s[1]=e("div",{class:"absolute left-3"},[e("img",{src:"/storage/images/search.svg",alt:"Ícone de pesquisa",class:"w-5 h-5 text-gray-500"})],-1)),Z(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=v=>u.value=v),placeholder:"Buscar um fornecedor",class:"search-input pl-10 w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[H,u.value]])]),e("div",ae,[(p(!0),h(I,null,K(c.value,v=>(p(),h("div",{key:v.id,class:"card cursor-pointer transform transition-transform duration-200 hover:shadow-lg",onClick:F=>m(v)},[e("div",re,[s[2]||(s[2]=e("div",{class:"icon-container"},[e("div",{class:"icon-bg"}),e("div",{class:"icon-leaf"},[e("img",{src:"/storage/images/servicos_verde.svg",alt:"Ícone do fornecedor",class:"w-5 h-5 rounded-lg"})])],-1)),e("div",le,[e("div",ne,C(v.razao_social),1),e("div",ie,C(v.cnpj)+" / "+C(v.estado),1)]),s[3]||(s[3]=e("div",{class:"action-icon"},null,-1))])],8,se))),128))])]))}},ce=L(de,[["__scopeId","data-v-a0b13445"]]),ue={key:0,class:"sidebar-container"},ve={key:0,class:"loading-overlay"},fe={key:1,class:"w-full h-[400px] bg-white rounded-[20px] p-12"},pe={class:"w-full py-2 bg-transparent border border-gray-300 rounded-lg outline-none text-base text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},me={class:"flex justify-start space-x-1 mt-[50px]"},ge={__name:"EditarFornecedor",props:{isVisible:{type:Boolean,required:!0},fornecedor:{type:Object,required:!0}},emits:["cancelar"],setup(x,{emit:y}){const d=M(),b=x,u=y,l=r(""),m=r(""),c=r(""),a=r(""),s=r(!1),v=r(!1),F=r("");T(()=>b.fornecedor,i=>{i&&(l.value=i.razao_social||"",m.value=i.email||"",c.value=i.whatsapp||"",a.value=i.estado||"")},{immediate:!0});const $=async()=>{var i,f;if(!l.value||!m.value||!c.value||!a.value){d.error("Preencha todos os campos obrigatórios.");return}try{s.value=!0;const n=new FormData;n.append("id",b.fornecedor.id),n.append("cnpj",b.fornecedor.cnpj),n.append("razao_social",l.value),n.append("email",m.value),n.append("whatsapp",c.value),n.append("estado",a.value);const j=await S({method:"post",url:"/api/fornecedores/atualizar",data:n,headers:{"Content-Type":"multipart/form-data"}});U.Inertia.replace(route("franqueadora.fornecedores"),{fornecedor:j.data.fornecedor,preserveState:!0}),d.success("Fornecedor atualizado com sucesso!")}catch(n){d.error("Erro ao atualizar o fornecedor."),errorMessage.value=((f=(i=n.response)==null?void 0:i.data)==null?void 0:f.message)||"Erro inesperado."}finally{s.value=!1}},D=i=>{F.value=i,v.value=!0},z=()=>{$(),v.value=!1},N=()=>{v.value=!1},V=()=>{u("cancelar")};return(i,f)=>x.isVisible?(p(),h("div",ue,[s.value?(p(),h("div",ve,f[5]||(f[5]=[e("div",{class:"spinner"},null,-1)]))):(p(),h("div",fe,[e("form",{onSubmit:R($,["prevent"])},[o(_,{text:"CNPJ"}),e("div",pe,C(x.fornecedor.cnpj||"N/A"),1),o(_,{text:"Razão Social"}),o(k,{modelValue:l.value,"onUpdate:modelValue":f[0]||(f[0]=n=>l.value=n),placeholder:""},null,8,["modelValue"]),o(_,{text:"E-mail"}),o(k,{modelValue:m.value,"onUpdate:modelValue":f[1]||(f[1]=n=>m.value=n),placeholder:""},null,8,["modelValue"]),o(_,{text:"WhatsApp"}),o(k,{modelValue:c.value,"onUpdate:modelValue":f[2]||(f[2]=n=>c.value=n),placeholder:""},null,8,["modelValue"]),o(_,{text:"Estado"}),o(k,{modelValue:a.value,"onUpdate:modelValue":f[3]||(f[3]=n=>a.value=n),placeholder:""},null,8,["modelValue"]),e("div",me,[o(O,{text:"Cancelar",onClick:V}),o(P,{text:"Atualizar",onClick:f[4]||(f[4]=n=>D("Atualizar esse Fornecedor?"))})])],32),o(q,{isVisible:v.value,motivo:F.value,onConfirm:z,onCancel:N},null,8,["isVisible","motivo"])]))])):E("",!0)}},xe=L(ge,[["__scopeId","data-v-92d72091"]]),he={key:0,class:"w-full h-[530px] bg-white rounded-[20px] p-7 relative"},be={class:"relative w-full h-full"},_e={class:"flex items-center"},ye={class:"absolute left-0 top-0 text-[#262a27] text-[28px] font-bold font-['Figtree'] leading-[50px] tracking-tight"},we={class:"w-1/1"},Ce={class:"relative w-full h-full"},Fe={class:"flex justify-between items-center absolute left-0 top-[50px] w-full"},Ve={class:"w-[150px] h-[43px] px-2.5 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},ke={class:"text-[#262a27] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},$e={class:"w-[219px] h-[43px] px-2.5 py-3 bg-[#f3f8f3] rounded-lg flex justify-between items-center"},Ee={class:"text-[#262a27] text-base font-semibold font-['Figtree'] leading-[13px] tracking-tight"},je={class:"mt-[130px]"},De={class:"w-full p-4 bg-transparent border border-gray-300 rounded-lg outline-none text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},ze={class:"text-[#262a27] text-base font-['Figtree'] leading-[13px] tracking-tight"},Ne={class:"mt-4"},Ae={class:"w-full p-4 bg-transparent border border-gray-300 rounded-lg outline-none text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},Se={class:"text-[#262a27] text-base font-['Figtree'] leading-[13px] tracking-tight"},Be={class:"mt-4"},Le={class:"w-full p-4 bg-transparent border border-gray-300 rounded-lg outline-none text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},Ie={class:"text-[#262a27] text-base font-['Figtree'] leading-[13px] tracking-tight"},Me={class:"mt-4"},Pe={class:"w-full p-4 bg-transparent border border-gray-300 rounded-lg outline-none text-center text-gray-700 focus:ring-2 focus:ring-green-500 font-['Figtree']"},Ue={class:"text-[#262a27] text-base font-['Figtree'] leading-[13px] tracking-tight"},qe={key:0,class:"mt-7"},Je={__name:"DetalhesFornecedor",props:{fornecedor:{type:Object,required:!0}},setup(x){const y=M(),d=r(!1),b=r(""),u=r(!1),l=r(!1),m=r(!1),c=x,a=r({...c.fornecedor}),s=async()=>{try{m.value=!0,await axios.delete(`/api/fornecedores/${c.fornecedor.id}`),U.Inertia.replace(route("franqueadora.fornecedores"),{preserveState:!0}),y.success("Fornecedor deletado com sucesso!")}catch(V){y.error(`Erro ao deletar o fornecedor: ${V.message}`)}finally{m.value=!1}},v=()=>{r.dadosfornecedor.fetchfornecedor()},F=()=>{l.value=!l.value,l.value||(a.value={...c.fornecedor})},$=V=>{b.value=V,d.value=!0},D=()=>{s(),d.value=!1},z=()=>{d.value=!1},N=()=>{l.value=!1,u.value=!0};return(V,i)=>{var f,n,j;return p(),h(I,null,[l.value?E("",!0):(p(),h("div",he,[e("div",be,[e("div",_e,[e("div",ye,C(((f=a.value)==null?void 0:f.razao_social)||a.value.razao_social||"N/A"),1),e("div",we,[o(q,{isVisible:d.value,motivo:b.value,onConfirm:D,onCancel:z},null,8,["isVisible","motivo"]),e("div",{class:"absolute top-3 right-4 cursor-pointer",onClick:i[0]||(i[0]=J=>$("Excluir esse Fornecedor?"))},i[1]||(i[1]=[e("img",{src:"/storage/images/delete.svg",alt:"Deletar Usuário",class:"w-6 h-6"},null,-1)]))]),e("div",Ce,[e("div",Fe,[e("div",Ve,[i[2]||(i[2]=e("div",{class:"w-6 h-6 rounded-full"},[e("img",{src:"/storage/images/storefront-bleck.svg",alt:"",class:"inline-block"})],-1)),e("div",ke," ID# "+C((((n=x.fornecedor)==null?void 0:n.id)??0).toString().padStart(4,"0")),1)]),e("div",$e,[i[3]||(i[3]=e("div",{class:"w-6 h-6 rounded-full"},[e("img",{src:"/storage/images/assured_workload.svg",alt:"",class:"inline-block"})],-1)),e("div",Ee,C(((j=x.fornecedor)==null?void 0:j.cnpj)||"N/A"),1)])])])]),e("div",je,[o(_,{text:"Razão Social"}),e("div",De,[e("div",ze,C(x.fornecedor.razao_social||"N/A"),1)])]),e("div",Ne,[o(_,{text:"E-mail"}),e("div",Ae,[e("div",Se,C(x.fornecedor.email||"N/A"),1)])]),e("div",Be,[o(_,{text:"WhatsApp"}),e("div",Le,[e("div",Ie,C(x.fornecedor.whatsapp||"N/A"),1)])]),e("div",Me,[o(_,{text:"Estado"}),e("div",Pe,[e("div",Ue,C(x.fornecedor.estado||"N/A"),1)])])]),x.fornecedor.id&&!l.value?(p(),h("div",qe,[o(oe,{text:"Editar insumos","icon-path":"/storage/images/border_color.svg",onClick:F,class:"px-4 py-2 bg-[#F8F8F8] text-white rounded-lg"})])):E("",!0)])),l.value?(p(),B(xe,{key:1,ref:"dadosfornecedor",isVisible:l.value,fornecedor:x.fornecedor,onDadosfornecedor:v,onCancelar:N},null,8,["isVisible","fornecedor"])):E("",!0)],64)}}},Te=L(Je,[["__scopeId","data-v-ebdaf86f"]]),Re={key:0,class:"sidebar-container"},We={key:0,class:"loading-overlay"},Oe={key:1,class:"w-full h-[525px] bg-white rounded-[20px] p-12"},Ge={key:0,class:"error-message"},Qe={class:"form-buttons"},Ze={__name:"CadastroFornecedor",props:{isVisible:{type:Boolean,required:!0}},emits:["cancelar"],setup(x,{emit:y}){const d=M(),b=y,u=r(""),l=r(""),m=r(""),c=r(""),a=r(""),s=r(""),v=r(!1),F=r(!1),$=r("");T(u,async w=>{w.replace(/\D/g,"").length===14&&await f()});const D=()=>{z(),b("cancelar")},z=()=>{u.value="",l.value="",m.value="",c.value="",a.value="",s.value=""},N=()=>u.value?!0:(d.error("Por favor, preencha todos os campos obrigatórios."),s.value="Por favor, preencha todos os campos obrigatórios.",!1),V=async()=>{var w,t;if(N())try{v.value=!0;const g=await S.post("/api/fornecedores",{razao_social:l.value,cnpj:u.value,email:m.value,whatsapp:c.value,estado:a.value});U.Inertia.replace(route("franqueadora.fornecedores"),{fornecedor:g.data.fornecedor,preserveState:!0}),d.success("Fornecedor cadastrado com sucesso!")}catch(g){d.error("Erro ao realizar o cadastro."),s.value=((t=(w=g.response)==null?void 0:w.data)==null?void 0:t.message)||"Erro ao realizar o cadastro."}finally{v.value=!1}},i=w=>{let t=w.target.value.replace(/\D/g,"");t.length>14&&(t=t.slice(0,14)),t=t.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/,"$1.$2.$3/$4-$5"),u.value=t},f=async()=>{var w,t;if(!u.value||u.value.length<14){d.error("Por favor, insira um CNPJ válido.");return}try{v.value=!0;const g=u.value.replace(/\D/g,""),A=(await S.get(`https://publica.cnpj.ws/cnpj/${g}`)).data;l.value=A.razao_social||"",a.value=A.estabelecimento.estado.nome||"",c.value=A.estabelecimento.telefone1||"",m.value=A.estabelecimento.email||""}catch(g){s.value=((t=(w=g.response)==null?void 0:w.data)==null?void 0:t.message)||"Erro ao consultar o CNPJ."}finally{v.value=!1}},n=w=>{$.value=w,F.value=!0},j=()=>{V(),F.value=!1},J=()=>{F.value=!1};return(w,t)=>(p(),B(X,{name:"fade"},{default:W(()=>[x.isVisible?(p(),h("div",Re,[v.value?(p(),h("div",We,t[6]||(t[6]=[e("div",{class:"spinner"},null,-1)]))):(p(),h("div",Oe,[t[7]||(t[7]=e("div",{class:"painel-title"},[e("p",null,"Novo fornecedor")],-1)),e("form",{onSubmit:R(V,["prevent"])},[o(_,{text:"CNPJ"}),o(k,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=g=>u.value=g),onInput:i,placeholder:"000.000.000/0000-00"},null,8,["modelValue"]),o(_,{text:"Razão Social"}),o(k,{modelValue:l.value,"onUpdate:modelValue":t[1]||(t[1]=g=>l.value=g),placeholder:"Silva Moura Pescados"},null,8,["modelValue"]),o(_,{text:"E-mail"}),o(k,{modelValue:m.value,"onUpdate:modelValue":t[2]||(t[2]=g=>m.value=g),placeholder:"contato@nobrezasdomar.com.br"},null,8,["modelValue"]),o(_,{text:"WhatsApp"}),o(k,{modelValue:c.value,"onUpdate:modelValue":t[3]||(t[3]=g=>c.value=g),placeholder:"(00) 00000-0000"},null,8,["modelValue"]),o(_,{text:"Estado"}),o(k,{modelValue:a.value,"onUpdate:modelValue":t[4]||(t[4]=g=>a.value=g),placeholder:"Mato Grosso"},null,8,["modelValue"]),s.value?(p(),h("div",Ge,C(s.value),1)):E("",!0),o(q,{isVisible:F.value,motivo:$.value,onConfirm:j,onCancel:J},null,8,["isVisible","motivo"]),e("div",Qe,[o(O,{text:"Cancelar",onClick:D}),o(P,{text:"Cadastrar",onClick:t[5]||(t[5]=g=>n("Criar novo Fornecedor?"))})])],32)]))])):E("",!0)]),_:1}))}},He=L(Ze,[["__scopeId","data-v-d38b4e2b"]]),Ke={class:"grid grid-cols-1 gap-[3rem] mt-3 sm:grid-cols-2"},Xe={class:"flex flex-col gap-4"},Ye={class:"absolute bottom-4 right-4"},eo={key:1,class:"mt-4"},po={__name:"Index",setup(x){const y=r(null),d=r(!1),b=()=>{d.value=!d.value},u=()=>{l(),d.value=!1},l=()=>{var a;(a=r("listarFornecedores").value)==null||a.fetchFornecedores()},m=c=>{y.value=c};return(c,a)=>(p(),B(G,null,{default:W(()=>[o(Y(ee),{title:"Fornecedores"}),e("div",Ke,[e("div",null,[o(ce,{ref:"listarFornecedores",onFornecedorCadastrado:l,onFornecedorSelecionado:m},null,512)]),e("div",Xe,[d.value?(p(),h("div",eo,[o(He,{isVisible:d.value,onFornecedorCadastrado:u,onCancelar:b},null,8,["isVisible"])])):(p(),h(I,{key:0},[y.value?(p(),B(Te,{key:0,fornecedor:y.value},null,8,["fornecedor"])):E("",!0),e("div",Ye,[o(P,{text:"Novo Fornecedor",iconPath:"/storage/images/arrow_left_alt.svg",onClick:b})])],64))])])]),_:1}))}};export{po as default};
