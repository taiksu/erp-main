import{l as A,d as i,i as M,k as B,c as U,o as n,w as z,b as a,a as e,u as O,Z as E,e as d,f as T,m as u,F as h,h as k,t as v,x as F,n as K,v as b,p as Z,g as L}from"./app-vGR4VHCP.js";import{L as G}from"./LayoutFranqueado-Dg4kLBEk.js";import{_ as p}from"./LabelModel-BQtPKLWR.js";import{B as q}from"./ButtonPrimaryMedio-C9HfT39S.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"mt-5"},Q={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-4"},W={class:"bg-white rounded-lg px-12 py-5"},X={class:"flex flex-col flex-1"},Y=["value"],ee=["value"],te=["value"],oe={class:"bg-white rounded-lg px-12 py-5"},se={class:"flex items-center -mt-9"},le={class:"w-[40px] h-[40px] ml-2",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ae=["points","fill"],re={class:"bg-white rounded-lg px-12 py-5"},ie={class:"mt-4 flex flex-col gap-3"},ne={class:"flex justify-between items-center px-4 py-2 rounded-lg"},de={class:"relative flex items-center w-full"},pe={class:"flex justify-between items-center px-4 py-2 rounded-lg"},ue={class:"flex justify-between items-center px-4 py-2 rounded-lg"},ce={class:"rounded-lg px-12 py-5"},ve={class:"flex items-center -mt-5"},xe={class:"font-bold text-[63.36px] text-[#424242] tracking-wider"},me={class:"flex items-center gap-2 text-[#6d6d6d] text-[15px] font-semibold -mt-4"},fe={class:"absolute bottom-4 right-4 botao-container"},ge={class:"w-[267px] h-[124.72px] relative"},_e={class:"w-[267px] h-[43.91px] left-0 top-[80.80px] absolute"},be={class:"w-full h-[42.16px] left-0 top-[30px] absolute opacity-80 bg-white rounded-lg border-2 border-[#d7d7db] justify-start items-center inline-flex overflow-hidden"},we={__name:"LimpesaSalmao",setup(ye){const x=A(),R=i([]),V=i([]),S=i([]),r=i(0),c=i(0),g=i("R$ 0,00"),m=i(""),_=i(!1),C=()=>{_.value=!0},N=()=>{_.value=!1},s=i({responsavel_id:"",fornecedor_id:"",calibre_id:"",valor_pago:"R$ 0,00",peso_bruto:"0,000",peso_limpo:"0,000"});M(async()=>{try{const l=await B.get("/api/gestao-residuos/limpeza");R.value=l.data.colaboradores,V.value=l.data.calibres,S.value=l.data.fornecedores}catch(l){console.error("Erro ao carregar dados:",l)}});const I=()=>{let l=s.value.valor_pago.replace(/\D/g,"");if(!l)s.value.valor_pago="R$ 0,00";else{let t=l.slice(0,-2)||"0",o=l.slice(-2).padStart(2,"0");s.value.valor_pago=`R$ ${Number(t).toLocaleString("pt-BR")},${o}`}P()},$=(l,t)=>{let o=t.replace(/\D/g,"");if(!o)s.value[l]="0,000";else{let w=o.slice(0,-3)||"0",y=o.slice(-3).padStart(3,"0");s.value[l]=`${Number(w).toLocaleString("pt-BR")},${y}`}D()},f=l=>parseFloat(l.replace(",",".")||"0"),D=()=>{const l=f(s.value.peso_bruto),t=f(s.value.peso_limpo);l>0?(r.value=(t/l*100).toFixed(2),c.value=(l-t).toFixed(3)):(r.value=0,c.value=0),P()},P=()=>{const l=parseFloat(s.value.valor_pago.replace(/[^\d,]/g,"").replace(",",".")||"0"),t=f(s.value.peso_bruto);if(t>0){const o=l/t,w=parseFloat(c.value),y=(o*w).toFixed(2);g.value=`R$ ${y.replace(".",",")}`}else g.value="R$ 0,00"},j=async()=>{if(!m.value){x.info("Por favor, insira seu PIN.");return}try{console.log("PIN:",m.value);const l=await B.post("/api/gestao-residuos/adicionar",{pin:m.value,responsavel_id:s.value.responsavel_id,fornecedor_id:s.value.fornecedor_id,calibre_id:s.value.calibre_id,valor_pago:parseFloat(s.value.valor_pago.replace(/[^\d,]/g,"").replace(",",".")),peso_bruto:f(s.value.peso_bruto),peso_limpo:f(s.value.peso_limpo),aproveitamento:parseFloat(r.value),desperdicio:parseFloat(c.value)});x.success("Operação realizada com sucesso!"),console.log("Registro salvo:",l.data),s.value={responsavel_id:"",calibre_id:"",fornecedor_id:"",valor_pago:"R$ 0,00",peso_bruto:"0,000",peso_limpo:"0,000"},r.value=0,c.value=0,g.value="R$ 0,00",_.value=!1}catch(l){if(l.response){const{status:t,data:o}=l.response;t===403?x.error("PIN incorreto. Verifique e tente novamente."):t===400?x.error(o.error||"ERRO: Ops! Chame o suporte se o erro continuar."):console.error("Erro:",l)}else x.error("Ops! Ouve um erro.")}};return(l,t)=>(n(),U(G,null,{default:z(()=>[a(O(E),{title:"Limpeza de Salmão"}),t[15]||(t[15]=e("div",{class:"flex justify-between items-center mb-4"},[e("div",null,[e("div",{class:"painel-title text-2xl sm:text-3xl md:text-4xl"}," Limpeza de Salmão "),e("div",{class:"painel-subtitle"},[e("p",{class:"text-sm sm:text-base md:text-lg"}," Registre o aproveitamento de salmão ")])])],-1)),e("div",J,[e("div",Q,[e("div",W,[e("div",X,[a(p,{text:"Responsável",class:"mb-2"}),u(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>s.value.responsavel_id=o),class:"input-select",required:""},[t[10]||(t[10]=e("option",{value:"",disabled:"",selected:""}," Selecione um Responsável ",-1)),(n(!0),d(h,null,k(R.value,o=>(n(),d("option",{key:o.id,value:o.id},v(o.name),9,Y))),128))],512),[[F,s.value.responsavel_id]]),a(p,{text:"Calibre do Salmão",class:"mb-2"}),u(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>s.value.calibre_id=o),class:"input-select",required:""},[t[11]||(t[11]=e("option",{value:"",disabled:"",selected:""},"Selecione um calibre",-1)),(n(!0),d(h,null,k(V.value,o=>(n(),d("option",{key:o.id,value:o.id},v(o.nome),9,ee))),128))],512),[[F,s.value.calibre_id]]),a(p,{text:"Fornecedor",class:"mb-2"}),u(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.value.fornecedor_id=o),class:"input-select",required:""},[t[12]||(t[12]=e("option",{value:"",disabled:"",selected:""}," Selecione um fornecedor ",-1)),(n(!0),d(h,null,k(S.value,o=>(n(),d("option",{key:o.id,value:o.id},v(o.razao_social),9,te))),128))],512),[[F,s.value.fornecedor_id]])])]),e("div",oe,[a(p,{text:"Aproveitamento"}),e("div",se,[e("span",{class:K({"font-bold text-[120.01px] tracking-wider":!0,"text-[#1d5915]":r.value>=70,"text-red-600":r.value<70})},v(r.value)+"% ",3),(n(),d("svg",le,[e("polygon",{points:r.value>=70?"12,2 22,20 2,20":"12,22 22,2 2,2",fill:r.value>=70?"#6DB631":"#DC2626"},null,8,ae)]))])]),e("div",re,[e("div",ie,[e("div",ne,[a(p,{text:"Valor Pago",class:"text-gray-800"}),e("div",de,[u(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>s.value.valor_pago=o),onInput:I,class:"input-text",placeholder:"R$ 0,00",required:""},null,544),[[b,s.value.valor_pago]])])]),e("div",pe,[a(p,{text:"Peso Líquido",class:"text-gray-800"}),u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>s.value.peso_bruto=o),onInput:t[5]||(t[5]=o=>$("peso_bruto",o.target.value)),class:"input-text",placeholder:"0,000",required:""},null,544),[[b,s.value.peso_bruto]])]),e("div",ue,[a(p,{text:"Peso Limpo",class:"text-gray-800"}),u(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>s.value.peso_limpo=o),onInput:t[7]||(t[7]=o=>$("peso_limpo",o.target.value)),class:"input-text",placeholder:"0,000",required:""},null,544),[[b,s.value.peso_limpo]])])])]),e("div",ce,[a(p,{text:"Desperdício"}),e("div",ve,[e("span",xe,v(c.value)+" kg ",1)]),e("div",me,[e("p",null,"Equivalente a "+v(g.value),1)])])]),e("div",fe,[a(q,{text:"Concluir",iconPath:"/storage/images/arrow_left_alt.svg",onClick:C})]),_.value?(n(),d("div",{key:0,onClick:N,class:"fixed top-0 left-0 right-0 bottom-0 bg-opacity-50 bg-gray-900 flex justify-center items-center"},[e("div",{onClick:t[9]||(t[9]=Z(()=>{},["stop"])),class:"w-[405px] h-[523px] px-[23px] py-[33px] bg-white rounded-[20px] flex-col justify-center items-center gap-[68px] inline-flex"},[t[14]||(t[14]=e("div",{class:"w-[267px] h-[229.61px] relative"},[e("div",{class:"left-[-0px] top-[93.84px] absolute text-center text-[#262a27] text-[42.18px] font-bold font-['Figtree'] leading-[50.61px] tracking-wide"},[L(" Autenticação "),e("br"),L(" Obrigatória ")]),e("div",{class:"left-[20.03px] top-[205.61px] absolute text-center text-[#6d6d6d] text-lg font-normal font-['Figtree'] leading-[23.20px]"}," Identifique-se para prosseguir "),e("div",{class:"w-[83.46px] h-[83.46px] left-[91.74px] top-0 absolute"},[e("div",{class:"w-[83.46px] h-[83.46px] left-0 top-0 absolute"},[e("img",{src:"/storage/images/security.svg",alt:""})])])],-1)),e("div",ge,[e("div",_e,[a(q,{onClick:j,text:"Autenticar",class:"w-full"})]),e("div",be,[u(e("input",{"onUpdate:modelValue":t[8]||(t[8]=o=>m.value=o),type:"password",class:"w-full h-full text-xs font-normal tracking-widest border-none outline-none",placeholder:"●●●●",autocomplete:"off"},null,512),[[b,m.value]])]),t[13]||(t[13]=e("div",{class:"w-[68.51px] left-0 top-0 absolute text-[#262a27] text-[14.93px] font-semibold font-['Figtree'] leading-tight"}," Seu PIN ",-1))])])])):T("",!0)])]),_:1}))}},Se=H(we,[["__scopeId","data-v-b4145f8f"]]);export{Se as default};
